# Year (time)
coral_yr = glm.nb(formula = Coral_Richness ~ Year, data = variables)
sponge_yr = glm.nb(formula = Sponge_Richness ~ Year, data = variables)
fish_yr = glm.nb(formula = Fish_Richness ~ Year, data = variables)
combined_yr = glm.nb(formula = Combined_Richness ~ Year, data = variables)
# Site (space)
coral_site = glm.nb(formula = Coral_Richness ~ Site, data = variables)
sponge_site = glm.nb(formula = Sponge_Richness ~ Site, data = variables)
fish_site = glm.nb(formula = Fish_Richness ~ Site, data = variables)
combined_site = glm.nb(formula = Combined_Richness ~ Site, data = variables)
# Year + Site
coral_yr_site = glm.nb(formula = Coral_Richness ~ Year + Site, data = variables)
sponge_yr_site = glm.nb(formula = Sponge_Richness ~ Year + Site, data = variables)
fish_yr_site = glm.nb(formula = Fish_Richness ~ Year + Site, data = variables)
combined_yr_site = glm.nb(formula = Combined_Richness ~ Year + Site, data = variables)
# Year + Site + YearxSite
coral_yr_site_yrxsite = glm.nb(formula = Coral_Richness ~ Year + Site + Year*Site, data = variables)
sponge_yr_site_yrxsite = glm.nb(formula = Sponge_Richness ~ Year + Site + Year*Site, data = variables)
fish_yr_site_yrxsite = glm.nb(formula = Fish_Richness ~ Year + Site + Year*Site, data = variables)
combined_yr_site_yrxsite = glm.nb(formula = Combined_Richness ~ Year + Site + Year*Site, data = variables)
## These models have surrogates:
# CC + Year (time)
coral_cc_yr = glm.nb(formula = Coral_Richness ~ Percent_Coral_Cover + Year, data = variables)
sponge_cc_yr = glm.nb(formula = Sponge_Richness ~ Percent_Coral_Cover + Year, data = variables)
fish_cc_yr = glm.nb(formula = Fish_Richness ~ Percent_Coral_Cover + Year, data = variables)
combined_cc_yr = glm.nb(formula = Combined_Richness ~ Percent_Coral_Cover + Year, data = variables)
# SC + Year (time)
coral_sc_yr = glm.nb(formula = Coral_Richness ~ Percent_Sponge_Cover + Year, data = variables)
sponge_sc_yr = glm.nb(formula = Sponge_Richness ~ Percent_Sponge_Cover + Year, data = variables)
fish_sc_yr = glm.nb(formula = Fish_Richness ~ Percent_Sponge_Cover + Year, data = variables)
combined_sc_yr = glm.nb(formula = Combined_Richness ~ Percent_Sponge_Cover + Year, data = variables)
# R + Year (time)
coral_r_yr = glm.nb(formula = Coral_Richness ~ Rugosity + Year, data = variables)
sponge_r_yr = glm.nb(formula = Sponge_Richness ~ Rugosity + Year, data = variables)
fish_r_yr = glm.nb(formula = Fish_Richness ~ Rugosity + Year, data = variables)
combined_r_yr = glm.nb(formula = Combined_Richness ~ Rugosity + Year, data = variables)
# CC + Site (space)
coral_cc_site = glm.nb(formula = Coral_Richness ~ Percent_Coral_Cover + Site, data = variables)
sponge_cc_site = glm.nb(formula = Sponge_Richness ~ Percent_Coral_Cover + Site, data = variables)
fish_cc_site = glm.nb(formula = Fish_Richness ~ Percent_Coral_Cover + Site, data = variables)
combined_cc_site = glm.nb(formula = Combined_Richness ~ Percent_Coral_Cover + Site, data = variables)
# SC + Site (space)
coral_sc_site = glm.nb(formula = Coral_Richness ~ Percent_Sponge_Cover + Site, data = variables)
sponge_sc_site = glm.nb(formula = Sponge_Richness ~ Percent_Sponge_Cover + Site, data = variables)
fish_sc_site = glm.nb(formula = Fish_Richness ~ Percent_Sponge_Cover + Site, data = variables)
combined_sc_site = glm.nb(formula = Combined_Richness ~ Percent_Sponge_Cover + Site, data = variables)
# R + Site (space)
coral_r_site = glm.nb(formula = Coral_Richness ~ Rugosity + Site, data = variables)
sponge_r_site = glm.nb(formula = Sponge_Richness ~ Rugosity + Site, data = variables)
fish_r_site = glm.nb(formula = Fish_Richness ~ Rugosity + Site, data = variables)
combined_r_site = glm.nb(formula = Combined_Richness ~ Rugosity + Site, data = variables)
# CC + Year + Site
coral_cc_yr_site = glm.nb(formula = Coral_Richness ~ Percent_Coral_Cover + Year + Site, data = variables)
sponge_cc_yr_site = glm.nb(formula = Sponge_Richness ~ Percent_Coral_Cover + Year + Site, data = variables)
fish_cc_yr_site = glm.nb(formula = Fish_Richness ~ Percent_Coral_Cover + Year + Site, data = variables)
combined_cc_yr_site = glm.nb(formula = Combined_Richness ~ Percent_Coral_Cover + Year + Site, data = variables)
# SC + Year + Site
coral_sc_yr_site = glm.nb(formula = Coral_Richness ~ Percent_Sponge_Cover + Year + Site, data = variables)
sponge_sc_yr_site = glm.nb(formula = Sponge_Richness ~ Percent_Sponge_Cover + Year + Site, data = variables)
fish_sc_yr_site = glm.nb(formula = Fish_Richness ~ Percent_Sponge_Cover + Year + Site, data = variables)
combined_sc_yr_site = glm.nb(formula = Combined_Richness ~ Percent_Sponge_Cover + Year + Site, data = variables)
# R + Year + Site
coral_r_yr_site = glm.nb(formula = Coral_Richness ~ Rugosity + Year + Site, data = variables)
sponge_r_yr_site = glm.nb(formula = Sponge_Richness ~ Rugosity + Year + Site, data = variables)
fish_r_yr_site = glm.nb(formula = Fish_Richness ~ Rugosity + Year + Site, data = variables)
combined_r_yr_site = glm.nb(formula = Combined_Richness ~ Rugosity + Year + Site, data = variables)
# CC + Year + YearxCC
coral_cc_yr_yrxcc = glm.nb(formula = Coral_Richness ~ Percent_Coral_Cover + Year + Year*Percent_Coral_Cover, data = variables)
sponge_cc_yr_yrxcc = glm.nb(formula = Sponge_Richness ~ Percent_Coral_Cover + Year + Year*Percent_Coral_Cover, data = variables)
fish_cc_yr_yrxcc = glm.nb(formula = Fish_Richness ~ Percent_Coral_Cover + Year + Year*Percent_Coral_Cover, data = variables)
combined_cc_yr_yrxcc = glm.nb(formula = Combined_Richness ~ Percent_Coral_Cover + Year + Year*Percent_Coral_Cover, data = variables)
# SC + Year + YearxSC
coral_sc_yr_yrxsc = glm.nb(formula = Coral_Richness ~ Percent_Sponge_Cover + Year + Year*Percent_Sponge_Cover, data = variables)
sponge_sc_yr_yrxsc = glm.nb(formula = Sponge_Richness ~ Percent_Sponge_Cover + Year + Year*Percent_Sponge_Cover, data = variables)
fish_sc_yr_yrxsc = glm.nb(formula = Fish_Richness ~ Percent_Sponge_Cover + Year + Year*Percent_Sponge_Cover, data = variables)
combined_sc_yr_yrxsc = glm.nb(formula = Combined_Richness ~ Percent_Sponge_Cover + Year + Year*Percent_Sponge_Cover, data = variables)
# R + Year + YearxR
coral_r_yr_yrxr = glm.nb(formula = Coral_Richness ~ Rugosity + Year + Year*Rugosity, data = variables)
sponge_r_yr_yrxr = glm.nb(formula = Sponge_Richness ~ Rugosity + Year + Year*Rugosity, data = variables)
fish_r_yr_yrxr = glm.nb(formula = Fish_Richness ~ Rugosity + Year + Year*Rugosity, data = variables)
combined_r_yr_yrxr = glm.nb(formula = Combined_Richness ~ Rugosity + Year + Year*Rugosity, data = variables)
# CC + Site + SitexCC
coral_cc_site_sitexcc = glm.nb(formula = Coral_Richness ~ Percent_Coral_Cover + Site + Site*Percent_Coral_Cover, data = variables)
sponge_cc_site_sitexcc = glm.nb(formula = Sponge_Richness ~ Percent_Coral_Cover + Site + Site*Percent_Coral_Cover, data = variables)
fish_cc_site_sitexcc = glm.nb(formula = Fish_Richness ~ Percent_Coral_Cover + Site + Site*Percent_Coral_Cover, data = variables)
combined_cc_site_sitexcc = glm.nb(formula = Combined_Richness ~ Percent_Coral_Cover + Site + Site*Percent_Coral_Cover, data = variables)
# SC + Site + SitexSC
coral_sc_site_sitexsc = glm.nb(formula = Coral_Richness ~ Percent_Sponge_Cover + Site + Site*Percent_Sponge_Cover, data = variables)
sponge_sc_site_sitexsc = glm.nb(formula = Sponge_Richness ~ Percent_Sponge_Cover + Site + Site*Percent_Sponge_Cover, data = variables)
fish_sc_site_sitexsc = glm.nb(formula = Fish_Richness ~ Percent_Sponge_Cover + Site + Site*Percent_Sponge_Cover, data = variables)
combined_sc_site_sitexsc = glm.nb(formula = Combined_Richness ~ Percent_Sponge_Cover + Site + Site*Percent_Sponge_Cover, data = variables)
# R + Site + SitexR
coral_r_site_sitexr = glm.nb(formula = Coral_Richness ~ Rugosity + Site + Site*Rugosity, data = variables)
sponge_r_site_sitexr = glm.nb(formula = Sponge_Richness ~ Rugosity + Site + Site*Rugosity, data = variables)
fish_r_site_sitexr = glm.nb(formula = Fish_Richness ~ Rugosity + Site + Site*Rugosity, data = variables)
combined_r_site_sitexr = glm.nb(formula = Combined_Richness ~ Rugosity + Site + Site*Rugosity, data = variables)
# # The following models are not included in AIC tables or interpretations
# # CC + Year + Site + YearxSite
# coral_cc_yr_site_yrxsite = glm.nb(formula = Coral_Richness ~ Percent_Coral_Cover + Year + Site + Year*Site, data = variables)
# sponge_cc_yr_site_yrxsite = glm.nb(formula = Sponge_Richness ~ Percent_Coral_Cover + Year + Site + Year*Site, data = variables)
# fish_cc_yr_site_yrxsite = glm.nb(formula = Fish_Richness ~ Percent_Coral_Cover + Year + Site + Year*Site, data = variables)
# combined_cc_yr_site_yrxsite = glm.nb(formula = Combined_Richness ~ Percent_Coral_Cover + Year + Site + Year*Site, data = variables)
# # SC + Year + Site + YearxSite
# coral_sc_yr_site_yrxsite = glm.nb(formula = Coral_Richness ~ Percent_Sponge_Cover + Year + Site + Year*Site, data = variables)
# sponge_sc_yr_site_yrxsite = glm.nb(formula = Sponge_Richness ~ Percent_Sponge_Cover + Year + Site + Year*Site, data = variables)
# fish_sc_yr_site_yrxsite = glm.nb(formula = Fish_Richness ~ Percent_Sponge_Cover + Year + Site + Year*Site, data = variables)
# combined_sc_yr_site_yrxsite = glm.nb(formula = Combined_Richness ~ Percent_Sponge_Cover + Year + Site + Year*Site, data = variables)
# # R + Year + Site + YearxSite
# coral_r_yr_site_yrxsite = glm.nb(formula = Coral_Richness ~ Rugosity + Year + Site + Year*Site, data = variables)
# sponge_r_yr_site_yrxsite = glm.nb(formula = Sponge_Richness ~ Rugosity + Year + Site + Year*Site, data = variables)
# fish_r_yr_site_yrxsite = glm.nb(formula = Fish_Richness ~ Rugosity + Year + Site + Year*Site, data = variables)
# combined_r_yr_site_yrxsite = glm.nb(formula = Combined_Richness ~ Rugosity + Year + Site + Year*Site, data = variables)
## AIC tables to evaluate surrogate effectiveness over space and time
# Names of coral cover models in order they are listed for the AIC tables
cc_modnames <- c("yr", "site", "yr_site", "yr_site_yrxsite", "cc", "cc_yr", "cc_site", "cc_yr_site",
"cc_yr_yrxcc", "cc_site_sitexcc")
# AIC to compare coral_cc models
coral_cc <- aictab(cand.set = list(coral_yr, coral_site, coral_yr_site, coral_yr_site_yrxsite,
coral_cc, coral_cc_yr, coral_cc_site, coral_cc_yr_site,
coral_cc_yr_yrxcc, coral_cc_site_sitexcc),
modnames = cc_modnames, digits = 4)
# AIC to compare sponge_cc models
sponge_cc <- aictab(cand.set = list(sponge_yr, sponge_site, sponge_yr_site, sponge_yr_site_yrxsite,
sponge_cc, sponge_cc_yr, sponge_cc_site, sponge_cc_yr_site,
sponge_cc_yr_yrxcc, sponge_cc_site_sitexcc),
modnames = cc_modnames, digits = 4)
# AIC to compare fish_cc models
fish_cc <- aictab(cand.set = list(fish_yr, fish_site, fish_yr_site, fish_yr_site_yrxsite,
fish_cc, fish_cc_yr, fish_cc_site, fish_cc_yr_site,
fish_cc_yr_yrxcc, fish_cc_site_sitexcc),
modnames = cc_modnames, digits = 4)
# AIC to compare combined_cc models
combined_cc <- aictab(cand.set = list(combined_yr, combined_site, combined_yr_site, combined_yr_site_yrxsite,
combined_cc, combined_cc_yr, combined_cc_site, combined_cc_yr_site,
combined_cc_yr_yrxcc, combined_cc_site_sitexcc),
modnames = cc_modnames, digits = 4)
# Names of sponge cover models in order they are listed for the AIC tables
sc_modnames <- c("yr", "site", "yr_site", "yr_site_yrxsite", "sc", "sc_yr", "sc_site", "sc_yr_site",
"sc_yr_yrxsc", "sc_site_sitexsc")
# AIC to compare coral_sc models
coral_sc <- aictab(cand.set = list(coral_yr, coral_site, coral_yr_site, coral_yr_site_yrxsite,
coral_sc, coral_sc_yr, coral_sc_site, coral_sc_yr_site,
coral_sc_yr_yrxsc, coral_sc_site_sitexsc),
modnames = sc_modnames, digits = 4)
# AIC to compare sponge_sc models
sponge_sc <- aictab(cand.set = list(sponge_yr, sponge_site, sponge_yr_site, sponge_yr_site_yrxsite,
sponge_sc, sponge_sc_yr, sponge_sc_site, sponge_sc_yr_site,
sponge_sc_yr_yrxsc, sponge_sc_site_sitexsc),
modnames = sc_modnames, digits = 4)
# AIC to compare fish_sc models
fish_sc <- aictab(cand.set = list(fish_yr, fish_site, fish_yr_site, fish_yr_site_yrxsite,
fish_sc, fish_sc_yr, fish_sc_site, fish_sc_yr_site,
fish_sc_yr_yrxsc, fish_sc_site_sitexsc),
modnames = sc_modnames, digits = 4)
# AIC to compare combined_sc models
combined_sc <- aictab(cand.set = list(combined_yr, combined_site, combined_yr_site, combined_yr_site_yrxsite,
combined_sc, combined_sc_yr, combined_sc_site, combined_sc_yr_site,
combined_sc_yr_yrxsc, combined_sc_site_sitexsc),
modnames = sc_modnames, digits = 4)
# Names of rugosity models in order they are listed for the AIC tables
r_modnames <- c("yr", "site", "yr_site", "yr_site_yrxsite", "r", "r_yr", "r_site", "r_yr_site",
"r_yr_yrxr", "r_site_sitexr")
# AIC to compare coral_r models
coral_r <- aictab(cand.set = list(coral_yr, coral_site, coral_yr_site, coral_yr_site_yrxsite,
coral_r, coral_r_yr, coral_r_site, coral_r_yr_site,
coral_r_yr_yrxr, coral_r_site_sitexr),
modnames = r_modnames, digits = 4)
# AIC to compare sponge_r models
sponge_r <- aictab(cand.set = list(sponge_yr, sponge_site, sponge_yr_site, sponge_yr_site_yrxsite,
sponge_r, sponge_r_yr, sponge_r_site, sponge_r_yr_site,
sponge_r_yr_yrxr, sponge_r_site_sitexr),
modnames = r_modnames, digits = 4)
# AIC to compare fish_r models
fish_r <- aictab(cand.set = list(fish_yr, fish_site, fish_yr_site, fish_yr_site_yrxsite,
fish_r, fish_r_yr, fish_r_site, fish_r_yr_site,
fish_r_yr_yrxr, fish_r_site_sitexr),
modnames = r_modnames, digits = 4)
# AIC to compare combined_r models
combined_r <- aictab(cand.set = list(combined_yr, combined_site, combined_yr_site, combined_yr_site_yrxsite,
combined_r, combined_r_yr, combined_r_site, combined_r_yr_site,
combined_r_yr_yrxr, combined_r_site_sitexr),
modnames = r_modnames, digits = 4)
## Save AIC tables for the top candidate surrogates for each target as .csv files
# write.table(x = coral_cc, file = "coral_cc.csv", sep = ",", col.names = TRUE,row.names = FALSE)
# write.table(x = sponge_cc, file = "sponge_cc.csv", sep = ",", col.names = TRUE,row.names = FALSE)
# write.table(x = fish_r, file = "fish_r.csv", sep = ",", col.names = TRUE,row.names = FALSE)
# write.table(x = combined_r, file = "combined_r.csv", sep = ",", col.names = TRUE,row.names = FALSE)
## Model output for competitive models (<2.0 deltaAIC)
# Look at significance of model coefficients
# For coral richness: coral cover as best surrogate
summary(coral_cc_yr)
summary(coral_cc_yr_yrxcc)
# For sponge richness: coral cover as best surrogate
summary(sponge_yr_site)
summary(sponge_cc_yr_site) #cc coefficient not significant
# For fish richness: rugosity as best surrogate
summary(fish_site)
summary(fish_r_site) #r coefficient not significant
summary(fish_yr_site) #yr coefficient not significant
# For combined richness: rugosity as best surrogate
summary(combined_r_yr_site)
########################################################################
### Objective 3: Determine the best predictors of each target given our model set.
obj_three_modnames <- c("yr", "site", "yr_site", "yr_site_yrxsite",
"cc", "cc_yr", "cc_site", "cc_yr_site",
"sc", "sc_yr", "sc_site", "sc_yr_site",
"r", "r_yr", "r_site", "r_yr_site",
"cc_yr_yrxcc", "cc_site_sitexcc",
"sc_yr_yrxsc", "sc_site_sitexsc",
"r_yr_yrxr", "r_site_sitexr")
# *** I'm unsure as to why, but the next 4 AIC tables can only be produced if I close the script,
# ***re-run the code, and DO NOT run any of the AIC tables above
# ***That is why these tables are saved in separate .csv files.
# AIC to compare all coral models
coral_all <- aictab(cand.set = list(coral_yr, coral_site, coral_yr_site, coral_yr_site_yrxsite,
coral_cc, coral_cc_yr, coral_cc_site, coral_cc_yr_site,
coral_sc, coral_sc_yr, coral_sc_site, coral_sc_yr_site,
coral_r, coral_r_yr, coral_r_site, coral_r_yr_site,
coral_cc_yr_yrxcc, coral_cc_site_sitexcc,
coral_sc_yr_yrxsc, coral_sc_site_sitexsc,
coral_r_yr_yrxr, coral_r_site_sitexr),
modnames = obj_three_modnames, digits = 4)
# AIC to compare all sponge models
sponge_all <- aictab(cand.set = list(sponge_yr, sponge_site, sponge_yr_site, sponge_yr_site_yrxsite,
sponge_cc, sponge_cc_yr, sponge_cc_site, sponge_cc_yr_site,
sponge_sc, sponge_sc_yr, sponge_sc_site, sponge_sc_yr_site,
sponge_r, sponge_r_yr, sponge_r_site, sponge_r_yr_site,
sponge_cc_yr_yrxcc, sponge_cc_site_sitexcc,
sponge_sc_yr_yrxsc, sponge_sc_site_sitexsc,
sponge_r_yr_yrxr, sponge_r_site_sitexr),
modnames = obj_three_modnames, digits = 4)
# AIC to compare all fish models
fish_all <- aictab(cand.set = list(fish_yr, fish_site, fish_yr_site, fish_yr_site_yrxsite,
fish_cc, fish_cc_yr, fish_cc_site, fish_cc_yr_site,
fish_sc, fish_sc_yr, fish_sc_site, fish_sc_yr_site,
fish_r, fish_r_yr, fish_r_site, fish_r_yr_site,
fish_cc_yr_yrxcc, fish_cc_site_sitexcc,
fish_sc_yr_yrxsc, fish_sc_site_sitexsc,
fish_r_yr_yrxr, fish_r_site_sitexr),
modnames = obj_three_modnames, digits = 4)
# AIC to compare all "combined" models
combined_all <- aictab(cand.set = list(combined_yr, combined_site, combined_yr_site, combined_yr_site_yrxsite,
combined_cc, combined_cc_yr, combined_cc_site, combined_cc_yr_site,
combined_sc, combined_sc_yr, combined_sc_site, combined_sc_yr_site,
combined_r, combined_r_yr, combined_r_site, combined_r_yr_site,
combined_cc_yr_yrxcc, combined_cc_site_sitexcc,
combined_sc_yr_yrxsc, combined_sc_site_sitexsc,
combined_r_yr_yrxr, combined_r_site_sitexr),
modnames = obj_three_modnames, digits = 4)
## Save these AIC tables as .csv files
# write.table(x = coral_all, file = "coral_all.csv", sep = ",", col.names = TRUE,row.names = FALSE)
# write.table(x = sponge_all, file = "sponge_all.csv", sep = ",", col.names = TRUE,row.names = FALSE)
# write.table(x = fish_all, file = "fish_all.csv", sep = ",", col.names = TRUE,row.names = FALSE)
# write.table(x = combined_all, file = "combined_all.csv", sep = ",", col.names = TRUE,row.names = FALSE)
## Model output for competitive models when models are included for all surrogates (<2.0 deltaAIC)
# Look at significance of model coefficients
# For coral richness
summary(coral_cc_yr)
summary(coral_cc_yr_yrxcc)
# For sponge richness
summary(sponge_r_yr_site) #r coefficient not significant (0.07)
summary(sponge_yr_site)
summary(sponge_cc_yr_site) #cc coefficient not significant
# For fish richness
summary(fish_site)
summary(fish_r_site) #r coefficient not significant
summary(fish_yr_site) #yr coefficient not significant
summary(fish_cc_site) #cc coefficient not significant
summary(fish_sc_site) #sc coefficient not significant
# For combined richness
# This is different than expected because this model includes coral cover even though
# rugosity was the top surrogate for combined richness.
summary(combined_cc_yr_site)
########################################################################
## Should I include sur + yr + sur*yr and/or sur + site + sur*site?
# These would mean that the effect of surrogate on target is different for different yrs (or sites)
# i.e. the slopes of regression lines are different for different sites or that there are 3 dimensions
## Should I include sur + yr + site + yr*site?
# NOT included because at this level of complexity, the surrogate would arguably not be a "simple" way to predict the target
# This would mean that the effect of time on the target is different for different sites and that
# the surrogate improves the model, but does not modify the effect of time or site on the target.
# This might be the case if different sites experience different conditions over time
# (e.g. disturbance is more common at one site than another and the level of disturbance changes over time)
# AND that there was additionally variation in the data that could be further explained by the surrogate
########################################################################
## Checking model assumption of negative binomial***
# Negative binomial models assume the conditional means are not equal to the conditional variances.
# This inequality is captured by estimating a dispersion parameter that is held constant in a Poisson model.
# Thus, the Poisson model is actually nested in the negative binomial model.
# We can then use a likelihood ratio test to compare these two and test this model assumption.
# To do this, we will run our model as a Poisson.
# (https://stats.idre.ucla.edu/r/dae/negative-binomial-regression/)
# These are the full models in the candidate set:
# coral_cc_yr_site; coral_sc_yr_site; coral_r_yr_site
# sponge_cc_yr_site; sponge_sc_yr_site; sponge_r_yr_site
# fish_cc_yr_site; fish_sc_yr_site; fish_r_yr_site
# combined_cc_yr_site; combined_sc_yr_site; combined_r_yr_site
# Create set of Poisson models for comparison
coral_cc_yr_site_pn <- glm(formula = Coral_Richness ~ Percent_Coral_Cover + Year + Site, family = "poisson", data = variables)
coral_sc_yr_site_pn <- glm(formula = Coral_Richness ~ Percent_Sponge_Cover + Year + Site, family = "poisson", data = variables)
coral_r_yr_site_pn <- glm(formula = Coral_Richness ~ Rugosity + Year + Site, family = "poisson", data = variables)
sponge_cc_yr_site_pn <- glm(formula = Sponge_Richness ~ Percent_Coral_Cover + Year + Site, family = "poisson", data = variables)
sponge_sc_yr_site_pn <- glm(formula = Sponge_Richness ~ Percent_Sponge_Cover + Year + Site, family = "poisson", data = variables)
sponge_r_yr_site_pn <- glm(formula = Sponge_Richness ~ Rugosity + Year + Site, family = "poisson", data = variables)
fish_cc_yr_site_pn <- glm(formula = Fish_Richness ~ Percent_Coral_Cover + Year + Site, family = "poisson", data = variables)
fish_sc_yr_site_pn <- glm(formula = Fish_Richness ~ Percent_Sponge_Cover + Year + Site, family = "poisson", data = variables)
fish_r_yr_site_pn <- glm(formula = Fish_Richness ~ Rugosity + Year + Site, family = "poisson", data = variables)
combined_cc_yr_site_pn <- glm(formula = Combined_Richness ~ Percent_Coral_Cover + Year + Site, family = "poisson", data = variables)
combined_sc_yr_site_pn <- glm(formula = Combined_Richness ~ Percent_Sponge_Cover + Year + Site, family = "poisson", data = variables)
combined_r_yr_site_pn <- glm(formula = Combined_Richness ~ Rugosity + Year + Site, family = "poisson", data = variables)
# From "Mixed Effects Models and Extensions in Ecology with R" by, Zuur, Ieno, et al. pg. 236
## For negative binomial
summary(coral_cc_yr_site)
# Drop each term in turn and compare the full model with the nested model using the drop1() command
drop1(coral_cc_yr_site, test = "Chi")
# Set up plot window, so I can view all diagnostic plots simultaneously
op <- par(mfrow = c(2,2))
# Plot residuals
plot(coral_cc_yr_site)
par(op)
## For Poisson
plot(coral_cc_yr_site_pn)
# Log-likelihood for Poisson
llhPoisson = logLik(coral_cc_yr_site_pn)
d <- 2 * (llhNB - llhPoisson)
# Determine p-value for chi-square test; multiply by 0.5 p. 238 *** still unsure as to why divide by 2 here
pval <- 0.5 * pchisq(q = as.numeric(x = d), df = 1, lower.tail = FALSE)
# p = 0.5, so there is no significant difference between using the neg. bin. and the Poisson***
# I looked at all 12 comparisons and for all of them, p = 0.5 suggesting there is no significant dif between neg. bin. and Poisson
# Plot residuals of all full models
# None of these models have patterns in the residuals,
# suggesting the models are appropriate
op <- par(mfrow = c(2,2))
plot(coral_cc_yr_site)
plot(coral_sc_yr_site)
plot(coral_r_yr_site)
plot(sponge_cc_yr_site)
plot(sponge_sc_yr_site)
plot(sponge_r_yr_site)
plot(fish_cc_yr_site)
plot(fish_sc_yr_site)
plot(fish_r_yr_site)
plot(combined_cc_yr_site)
plot(combined_sc_yr_site)
plot(combined_r_yr_site)
par(op)
# ***Following notes in this section from before
#pchisq(2 * (logLik(coral_cc_yr_site) - logLik(coral_cc_yr_site_pn)), df = 1, lower.tail = FALSE)
# 'log Lik.' 1 (df=10)
# Below are the results in the example at https://stats.idre.ucla.edu/r/dae/negative-binomial-regression/
# However, I don't understand how they got 926.03...
# ## 'log Lik.' 2.157e-203 (df=5)
# In this example the associated chi-squared value estimated from 2*(logLik(m1) – logLik(m3)) is 926.03 with one degree of freedom.
# This strongly suggests the negative binomial model, estimating the dispersion parameter, is more appropriate than the Poisson model.
########################################################################
# ## Figures of basic relationships between surrogates (x) and targets (y)
#
# # Figure 1. Relationship between coral cover and coral richness.
basic_coral_cc <- ggplot(data = variables, aes(x = Percent_Coral_Cover, y = Coral_Richness)) +
geom_point(size = 3) +
scale_x_continuous(name = "Coral Cover (%)") +
scale_y_continuous(name = "Coral Richness") +
theme(text = element_text(size = 27),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
#
# # Figure 2. Relationship between coral cover and sponge richness.
basic_sponge_cc <- ggplot(data = variables, aes(x = Percent_Coral_Cover, y = Sponge_Richness)) +
geom_point(size = 3) +
scale_x_continuous(name = "Coral Cover (%)") +
scale_y_continuous(name = "Sponge Richness") +
theme(text = element_text(size = 27),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
# # Resulting warning message just lets you know that there are years and sites for which these data are unavailable.
# # This does not change the resulting plot except that it will have fewer points than similar plots.
#
# # Figure 3. Relationship between coral cover and fish richness.
basic_fish_cc <- ggplot(data = variables, aes(x = Percent_Coral_Cover, y = Fish_Richness)) +
geom_point(size = 3) +
scale_x_continuous(name = "Coral Cover (%)") +
scale_y_continuous(name = "Fish Richness") +
theme(text = element_text(size = 27),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
#
# # Figure 4. Relationship between coral cover and combined richness.
basic_combined_cc <- ggplot(data = variables, aes(x = Percent_Coral_Cover, y = Combined_Richness)) +
geom_point(size = 3) +
scale_x_continuous(name = "Coral Cover (%)") +
scale_y_continuous(name = "Combined Richness") +
theme(text = element_text(size = 27),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
# # Resulting warning message similar to that from figure 2.
# # Combined richness was only calculated for sites and years when richness was recorded for all 3 groups.
#
# # Figure 5. Relationship between sponge cover and coral richness.
basic_coral_sc <- ggplot(data = variables, aes(x = Percent_Sponge_Cover, y = Coral_Richness)) +
geom_point(size = 3) +
scale_x_continuous(name = "Sponge Cover (%)") +
scale_y_continuous(name = "Coral Richness") +
theme(text = element_text(size = 27),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
# # Figure 6. Relationship between sponge cover and sponge richness.
basic_sponge_sc <- ggplot(data = variables, aes(x = Percent_Sponge_Cover, y = Sponge_Richness)) +
geom_point(size = 3) +
scale_x_continuous(name = "Sponge Cover (%)") +
scale_y_continuous(name = "Sponge Richness") +
theme(text = element_text(size = 27),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
# # Resulting warning message same as that from figure 2.
#
# # Figure 7. Relationship between sponge cover and fish richness.
basic_fish_sc <- ggplot(data = variables, aes(x = Percent_Sponge_Cover, y = Fish_Richness)) +
geom_point(size = 3) +
scale_x_continuous(name = "Sponge Cover (%)") +
scale_y_continuous(name = "Fish Richness") +
theme(text = element_text(size = 27),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
#
# # Figure 8. Relationship between sponge cover and combined richness.
basic_combined_sc <- ggplot(data = variables, aes(x = Percent_Sponge_Cover, y = Combined_Richness)) +
geom_point(size = 3) +
scale_x_continuous(name = "Sponge Cover (%)") +
scale_y_continuous(name = "Combined Richness") +
theme(text = element_text(size = 27),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
# # Resulting warning message same as that from figure 4.
#
# # Figure 9. Relationship between rugosity and coral richness.
basic_coral_r <- ggplot(data = variables, aes(x = Rugosity, y = Coral_Richness)) +
geom_point(size = 3) +
scale_x_continuous(name = "Rugosity") +
scale_y_continuous(name = "Coral Richness") +
theme(text = element_text(size = 27),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
#
# # Figure 10. Relationship between rugosity and sponge richness.
basic_sponge_r <- ggplot(data = variables, aes(x = Rugosity, y = Sponge_Richness)) +
geom_point(size = 3) +
scale_x_continuous(name = "Rugosity") +
scale_y_continuous(name = "Sponge Richness") +
theme(text = element_text(size = 27),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
# # Resulting warning message same as that from figure 2.
#
# # Figure 11. Relationship between rugosity and fish richness.
basic_fish_r <- ggplot(data = variables, aes(x = Rugosity, y = Fish_Richness)) +
geom_point(size = 3) +
scale_x_continuous(name = "Rugosity") +
scale_y_continuous(name = "Fish Richness") +
theme(text = element_text(size = 27),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
#
# # Figure 12. Relationship between rugosity and combined richness.
basic_combined_r <- ggplot(data = variables, aes(x = Rugosity, y = Combined_Richness)) +
geom_point(size = 3) +
scale_x_continuous(name = "Rugosity") +
scale_y_continuous(name = "Combined Richness") +
theme(text = element_text(size = 27),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
# # Resulting warning message same as that from figure 4.
# Organize all of these figures into one window for objective 1
grid.arrange(basic_coral_cc, basic_coral_sc, basic_coral_r,
basic_sponge_cc, basic_sponge_sc, basic_sponge_r,
basic_fish_cc, basic_fish_sc, basic_fish_r,
basic_combined_cc, basic_combined_sc, basic_combined_r,
ncol = 3, nrow = 4)
grid.arrange(basic_coral_cc, basic_coral_sc, basic_coral_r,
basic_sponge_cc, basic_sponge_sc, basic_sponge_r,
basic_fish_cc, basic_fish_sc, basic_fish_r,
basic_combined_cc, basic_combined_sc, basic_combined_r,
ncol = 3, nrow = 4)
source('C:/Users/Nicole/Desktop/Graduate Thesis 3-29-18/Analysis/Negative_Binomial_Models.R', echo=TRUE)
grid.arrange(basic_coral_cc, basic_coral_sc, basic_coral_r,
basic_sponge_cc, basic_sponge_sc, basic_sponge_r,
basic_fish_cc, basic_fish_sc, basic_fish_r,
basic_combined_cc, basic_combined_sc, basic_combined_r,
ncol = 3, nrow = 4)
