coral_r_yr_site = glm.nb(Coral_Richness ~ Rugosity + Year + Site, data = variables)
sponge_r_yr_site = glm.nb(Sponge_Richness ~ Rugosity + Year + Site, data = variables)
fish_r_yr_site = glm.nb(Fish_Richness ~ Rugosity + Year + Site, data = variables)
combined_r_yr_site = glm.nb(Combined_Richness ~ Rugosity + Year + Site, data = variables)
# CC + Year + Site + YearxSite
coral_cc_yr_site_yrxsite = glm.nb(Coral_Richness ~ Percent_Coral_Cover + Year + Site + Year*Site, data = variables)
sponge_cc_yr_site_yrxsite = glm.nb(Sponge_Richness ~ Percent_Coral_Cover + Year + Site + Year*Site, data = variables)
fish_cc_yr_site_yrxsite = glm.nb(Fish_Richness ~ Percent_Coral_Cover + Year + Site + Year*Site, data = variables)
combined_cc_yr_site_yrxsite = glm.nb(Combined_Richness ~ Percent_Coral_Cover + Year + Site + Year*Site, data = variables)
# SC + Year + Site + YearxSite
coral_sc_yr_site_yrxsite = glm.nb(Coral_Richness ~ Percent_Sponge_Cover + Year + Site + Year*Site, data = variables)
sponge_sc_yr_site_yrxsite = glm.nb(Sponge_Richness ~ Percent_Sponge_Cover + Year + Site + Year*Site, data = variables)
fish_sc_yr_site_yrxsite = glm.nb(Fish_Richness ~ Percent_Sponge_Cover + Year + Site + Year*Site, data = variables)
combined_sc_yr_site_yrxsite = glm.nb(Combined_Richness ~ Percent_Sponge_Cover + Year + Site + Year*Site, data = variables)
# R + Year + Site + YearxSite
coral_r_yr_site_yrxsite = glm.nb(Coral_Richness ~ Rugosity + Year + Site + Year*Site, data = variables)
sponge_r_yr_site_yrxsite = glm.nb(Sponge_Richness ~ Rugosity + Year + Site + Year*Site, data = variables)
fish_r_yr_site_yrxsite = glm.nb(Fish_Richness ~ Rugosity + Year + Site + Year*Site, data = variables)
combined_r_yr_site_yrxsite = glm.nb(Combined_Richness ~ Rugosity + Year + Site + Year*Site, data = variables)
## AIC tables to evaluate surrogate effectiveness over space and time
# Names of coral cover models in order they are listed for the AIC tables
cc_modnames <- c("yr", "site", "yr_site", "yr_site_yrxsite", "cc", "cc_yr", "cc_site", "cc_yr_site", "cc_yr_site_yrxsite")
# AIC to compare coral_cc models
coral_cc <- aictab(cand.set = list(coral_yr, coral_site, coral_yr_site, coral_yr_site_yrxsite,
coral_cc, coral_cc_yr, coral_cc_site, coral_cc_yr_site, coral_cc_yr_site_yrxsite),
modnames = cc_modnames, digits = 4)
# AIC to compare sponge_cc models
sponge_cc <- aictab(cand.set = list(sponge_yr, sponge_site, sponge_yr_site, sponge_yr_site_yrxsite,
sponge_cc, sponge_cc_yr, sponge_cc_site, sponge_cc_yr_site, sponge_cc_yr_site_yrxsite),
modnames = cc_modnames, digits = 4)
# AIC to compare fish_cc models
fish_cc <- aictab(cand.set = list(fish_yr, fish_site, fish_yr_site, fish_yr_site_yrxsite,
fish_cc, fish_cc_yr, fish_cc_site, fish_cc_yr_site, fish_cc_yr_site_yrxsite),
modnames = cc_modnames, digits = 4)
# AIC to compare combined_cc models
combined_cc <- aictab(cand.set = list(combined_yr, combined_site, combined_yr_site, combined_yr_site_yrxsite,
combined_cc, combined_cc_yr, combined_cc_site, combined_cc_yr_site, combined_cc_yr_site_yrxsite),
modnames = cc_modnames, digits = 4)
# Names of coral cover models in order they are listed for the AIC tables
sc_modnames <- c("yr", "site", "yr_site", "yr_site_yrxsite", "sc", "sc_yr", "sc_site", "sc_yr_site", "sc_yr_site_yrxsite")
# AIC to compare coral_sc models
coral_sc <- aictab(cand.set = list(coral_yr, coral_site, coral_yr_site, coral_yr_site_yrxsite,
coral_sc, coral_sc_yr, coral_sc_site, coral_sc_yr_site, coral_sc_yr_site_yrxsite),
modnames = sc_modnames, digits = 4)
# AIC to compare sponge_sc models
sponge_sc <- aictab(cand.set = list(sponge_yr, sponge_site, sponge_yr_site, sponge_yr_site_yrxsite,
sponge_sc, sponge_sc_yr, sponge_sc_site, sponge_sc_yr_site, sponge_sc_yr_site_yrxsite),
modnames = sc_modnames, digits = 4)
# AIC to compare fish_sc models
fish_sc <- aictab(cand.set = list(fish_yr, fish_site, fish_yr_site, fish_yr_site_yrxsite,
fish_sc, fish_sc_yr, fish_sc_site, fish_sc_yr_site, fish_sc_yr_site_yrxsite),
modnames = sc_modnames, digits = 4)
# AIC to compare combined_sc models
combined_sc <- aictab(cand.set = list(combined_yr, combined_site, combined_yr_site, combined_yr_site_yrxsite,
combined_sc, combined_sc_yr, combined_sc_site, combined_sc_yr_site, combined_sc_yr_site_yrxsite),
modnames = sc_modnames, digits = 4)
# Names of coral cover models in order they are listed for the AIC tables
r_modnames <- c("yr", "site", "yr_site", "yr_site_yrxsite", "r", "r_yr", "r_site", "r_yr_site", "r_yr_site_yrxsite")
# AIC to compare coral_r models
coral_r <- aictab(cand.set = list(coral_yr, coral_site, coral_yr_site, coral_yr_site_yrxsite,
coral_r, coral_r_yr, coral_r_site, coral_r_yr_site, coral_r_yr_site_yrxsite),
modnames = r_modnames, digits = 4)
# AIC to compare sponge_r models
sponge_r <- aictab(cand.set = list(sponge_yr, sponge_site, sponge_yr_site, sponge_yr_site_yrxsite,
sponge_r, sponge_r_yr, sponge_r_site, sponge_r_yr_site, sponge_r_yr_site_yrxsite),
modnames = r_modnames, digits = 4)
# AIC to compare fish_r models
fish_r <- aictab(cand.set = list(fish_yr, fish_site, fish_yr_site, fish_yr_site_yrxsite,
fish_r, fish_r_yr, fish_r_site, fish_r_yr_site, fish_r_yr_site_yrxsite),
modnames = r_modnames, digits = 4)
# AIC to compare combined_r models
combined_r <- aictab(cand.set = list(combined_yr, combined_site, combined_yr_site, combined_yr_site_yrxsite,
combined_r, combined_r_yr, combined_r_site, combined_r_yr_site, combined_r_yr_site_yrxsite),
modnames = r_modnames, digits = 4)
########################################################################
### Objective 3:Determine the best predictors of each target given our model set.
obj_three_modnames <- c("yr", "site", "yr_site", "yr_site_yrxsite",
"cc", "cc_yr", "cc_site", "cc_yr_site", "cc_yr_site_yrxsite",
"sc", "sc_yr", "sc_site", "sc_yr_site", "sc_yr_site_yrxsite",
"r", "r_yr", "r_site", "r_yr_site", "r_yr_site_yrxsite")
# AIC to compare all coral models
coral_all <- aictab(cand.set = list(coral_yr, coral_site, coral_yr_site, coral_yr_site_yrxsite,
coral_cc, coral_cc_yr, coral_cc_site, coral_cc_yr_site, coral_cc_yr_site_yrxsite,
coral_sc, coral_sc_yr, coral_sc_site, coral_sc_yr_site, coral_sc_yr_site_yrxsite,
coral_r, coral_r_yr, coral_r_site, coral_r_yr_site, coral_r_yr_site_yrxsite),
modnames = obj_three_modnames, digits = 4)
# AIC to compare all sponge models
sponge_all <- aictab(cand.set = list(sponge_yr, sponge_site, sponge_yr_site, sponge_yr_site_yrxsite,
sponge_cc, sponge_cc_yr, sponge_cc_site, sponge_cc_yr_site, sponge_cc_yr_site_yrxsite,
sponge_sc, sponge_sc_yr, sponge_sc_site, sponge_sc_yr_site, sponge_sc_yr_site_yrxsite,
sponge_r, sponge_r_yr, sponge_r_site, sponge_r_yr_site, sponge_r_yr_site_yrxsite),
modnames = obj_three_modnames, digits = 4)
# AIC to compare all fish models
fish_all <- aictab(cand.set = list(fish_yr, fish_site, fish_yr_site, fish_yr_site_yrxsite,
fish_cc, fish_cc_yr, fish_cc_site, fish_cc_yr_site, fish_cc_yr_site_yrxsite,
fish_sc, fish_sc_yr, fish_sc_site, fish_sc_yr_site, fish_sc_yr_site_yrxsite,
fish_r, fish_r_yr, fish_r_site, fish_r_yr_site, fish_r_yr_site_yrxsite),
modnames = obj_three_modnames, digits = 4)
# AIC to compare all "combined" models
combined_all <- aictab(cand.set = list(combined_yr, combined_site, combined_yr_site, combined_yr_site_yrxsite,
combined_cc, combined_cc_yr, combined_cc_site, combined_cc_yr_site, combined_cc_yr_site_yrxsite,
combined_sc, combined_sc_yr, combined_sc_site, combined_sc_yr_site, combined_sc_yr_site_yrxsite,
combined_r, combined_r_yr, combined_r_site, combined_r_yr_site, combined_r_yr_site_yrxsite),
modnames = obj_three_modnames, digits = 4)
View(combined_cc)
View(combined_r)
View(combined_sc)
coral_all <- aictab(cand.set = list(coral_yr, coral_site, coral_yr_site, coral_yr_site_yrxsite,
coral_cc, coral_cc_yr, coral_cc_site, coral_cc_yr_site, coral_cc_yr_site_yrxsite,
coral_sc, coral_sc_yr, coral_sc_site, coral_sc_yr_site, coral_sc_yr_site_yrxsite,
coral_r, coral_r_yr, coral_r_site, coral_r_yr_site, coral_r_yr_site_yrxsite),
digits = 4)
obj_three_modnames <- c("yr", "site", "yr_site", "yr_site_yrxsite", "cc", "cc_yr", "cc_site", "cc_yr_site", "cc_yr_site_yrxsite", "sc", "sc_yr", "sc_site", "sc_yr_site", "sc_yr_site_yrxsite", "r", "r_yr", "r_site", "r_yr_site", "r_yr_site_yrxsite")
coral_all <- aictab(cand.set = list(coral_yr, coral_site, coral_yr_site, coral_yr_site_yrxsite,
coral_cc, coral_cc_yr, coral_cc_site, coral_cc_yr_site, coral_cc_yr_site_yrxsite,
coral_sc, coral_sc_yr, coral_sc_site, coral_sc_yr_site, coral_sc_yr_site_yrxsite,
coral_r, coral_r_yr, coral_r_site, coral_r_yr_site, coral_r_yr_site_yrxsite),
modnames = obj_three_modnames, digits = 4)
coral_all <- aictab(cand.set = list(coral_yr, coral_site, coral_yr_site, coral_yr_site_yrxsite,
coral_cc, coral_cc_yr, coral_cc_site, coral_cc_yr_site, coral_cc_yr_site_yrxsite,
coral_sc, coral_sc_yr, coral_sc_site, coral_sc_yr_site, coral_sc_yr_site_yrxsite,
coral_r, coral_r_yr, coral_r_site, coral_r_yr_site, coral_r_yr_site_yrxsite),
modnames = obj_three_modnames, digits = 4)
fish_r <- aictab(cand.set = list(fish_yr, fish_site, fish_yr_site, fish_yr_site_yrxsite,
fish_r, fish_r_yr, fish_r_site, fish_r_yr_site, fish_r_yr_site_yrxsite),
modnames = r_modnames, digits = 4)
View(coral_sc)
### Nicole Keefner
### Master's Thesis: Develop models and figures using variables.csv
#*7* = need on 3/26 OR errors OR extraneous code
## Use *** to search for errors in the code or areas that need more work
## Use ***AIC to search for beginning of AIC code
## Use ***Simple Figures with Models to search for beginning of this figure code
## Use ***Simple Figures for Fish Richness to search for beginning of this figure code
## Use ***Simple Figures for Sponge Richness to search for beginning of this figure code
## Use ***Simple Figures for Coral Richness to search for beginning of this figure code
## Use ***Simple Figures for Combined Richness to search for beginning of this figure code
## Set Working Directory
## Install packages
## Load packages
# First used for model output in HTML table format using function tab_model
library(sjPlot)
# First used for aic function, aictab
library(AICcmodavg)
# First used to make figures using function ggplot
library(ggplot2)
# First used for negative binomial modeling using function glm.nb
library(MASS)
## Import variables.csv dataset
variables <- read.csv("variables.csv", header = T)
# Note that year is treated as type integer and is therefore continuous
# 4 targets: richness of corals, sponges, fishes, and combined
# 3 surrogates: percent coral cover, percent sponge cover, rugosity
# Because there are NA's in the Sponge_Richness column, R will be unable to calculate summary values
# Create subset of data called "sponge_complete" that retains only complete cases for Sponge_Richness
sponge_complete <- variables[complete.cases(variables$Sponge_Richness), ]
# Create dataframe with means and SD's for all variables
avg_name <-c("Percent_Coral_Cover",
"Percent_Sponge_Cover",
"Rugosity",
"Coral_Richness",
"Sponge_Richness",
"Fish_Richness",
"Combined_Richness")
avg_mean <-c(round(mean(variables$Percent_Coral_Cover), digits = 3),
round(mean(variables$Percent_Sponge_Cover), digits = 3),
round(mean(sponge_complete$Rugosity), digits = 3),
round(mean(variables$Coral_Richness), digits = 3),
round(mean(variables$Sponge_Richness), digits = 3),
round(mean(variables$Fish_Richness), digits = 3),
round(mean(sponge_complete$Combined_Richness), digits = 3))
avg_sd <-c(round(sd(variables$Percent_Coral_Cover), digits = 3),
round(sd(variables$Percent_Sponge_Cover), digits = 3),
round(sd(sponge_complete$Rugosity), digits = 3),
round(sd(variables$Coral_Richness), digits = 3),
round(sd(variables$Sponge_Richness), digits = 3),
round(sd(variables$Fish_Richness), digits = 3),
round(sd(sponge_complete$Combined_Richness), digits = 3))
avg_df <- data.frame(avg_name, avg_mean, avg_sd)
# Graph frequency distributions of response variables
hist(variables$Percent_Coral_Cover, breaks = 25)
hist(variables$Percent_Sponge_Cover, breaks = 25)
hist(variables$Rugosity, breaks = 25)
hist(variables$Coral_Richness, breaks = 25)
hist(variables$Sponge_Richness, breaks = 25)
hist(variables$Fish_Richness, breaks = 25)
hist(variables$Combined_Richness, breaks = 25)
########################################################################
### Objective 1: Create models that only include terms for surrogates
### in order to determine which of the 3 candidate surrogates is the best at predicting each target.
# Negative binomial distribution models and aic tables for each target with one surrogate
# For each target, compare models in aic table
coral_cc = glm.nb(formula = Coral_Richness ~ Percent_Coral_Cover, data = variables)
coral_sc = glm.nb(formula = Coral_Richness ~ Percent_Sponge_Cover, data = variables)
coral_r = glm.nb(formula = Coral_Richness ~ Rugosity, data = variables)
coral_surrogate <- aictab(cand.set = list(coral_cc, coral_sc, coral_r), modnames = c("coral_cc", "coral_sc", "coral_r"), digits = 4)
sponge_cc = glm.nb(formula = Sponge_Richness ~ Percent_Coral_Cover, data = variables)
sponge_sc = glm.nb(formula = Sponge_Richness ~ Percent_Sponge_Cover, data = variables)
sponge_r = glm.nb(formula = Sponge_Richness ~ Rugosity, data = variables)
sponge_surrogate <- aictab(cand.set = list(sponge_cc, sponge_sc, sponge_r), modnames = c("sponge_cc", "sponge_sc", "sponge_r"), digits = 4)
fish_cc = glm.nb(formula = Fish_Richness ~ Percent_Coral_Cover, data = variables)
fish_sc = glm.nb(formula = Fish_Richness ~ Percent_Sponge_Cover, data = variables)
fish_r = glm.nb(formula = Fish_Richness ~ Rugosity, data = variables)
fish_surrogate <- aictab(cand.set = list(fish_cc, fish_sc, fish_r), modnames = c("fish_cc", "fish_sc", "fish_r"), digits = 4)
combined_cc = glm.nb(formula = Combined_Richness ~ Percent_Coral_Cover, data = variables)
combined_sc = glm.nb(formula = Combined_Richness ~ Percent_Sponge_Cover, data = variables)
combined_r = glm.nb(formula = Combined_Richness ~ Rugosity, data = variables)
combined_surrogate <- aictab(cand.set = list(combined_cc, combined_sc, combined_r), modnames = c("combined_cc", "combined_sc", "combined_r"), digits = 4)
########################################################################
### Objective 2: Determine if relationships between targets and candidate
### surrogates remain consistent over space and time.
## No surrogates in these models:
# Year (time)
coral_yr = glm.nb(Coral_Richness ~ Year, data = variables)
sponge_yr = glm.nb(Sponge_Richness ~ Year, data = variables)
fish_yr = glm.nb(Fish_Richness ~ Year, data = variables)
combined_yr = glm.nb(Combined_Richness ~ Year, data = variables)
# Site (space)
coral_site = glm.nb(Coral_Richness ~ Site, data = variables)
sponge_site = glm.nb(Sponge_Richness ~ Site, data = variables)
fish_site = glm.nb(Fish_Richness ~ Site, data = variables)
combined_site = glm.nb(Combined_Richness ~ Site, data = variables)
# Year + Site
coral_yr_site = glm.nb(Coral_Richness ~ Year + Site, data = variables)
sponge_yr_site = glm.nb(Sponge_Richness ~ Year + Site, data = variables)
fish_yr_site = glm.nb(Fish_Richness ~ Year + Site, data = variables)
combined_yr_site = glm.nb(Combined_Richness ~ Year + Site, data = variables)
# Year + Site + YearxSite
coral_yr_site_yrxsite = glm.nb(Coral_Richness ~ Year + Site + Year*Site, data = variables)
sponge_yr_site_yrxsite = glm.nb(Sponge_Richness ~ Year + Site + Year*Site, data = variables)
fish_yr_site_yrxsite = glm.nb(Fish_Richness ~ Year + Site + Year*Site, data = variables)
combined_yr_site_yrxsite = glm.nb(Combined_Richness ~ Year + Site + Year*Site, data = variables)
## These models have surrogates:
# CC + Year (time)
coral_cc_yr = glm.nb(Coral_Richness ~ Percent_Coral_Cover + Year, data = variables)
sponge_cc_yr = glm.nb(Sponge_Richness ~ Percent_Coral_Cover + Year, data = variables)
fish_cc_yr = glm.nb(Fish_Richness ~ Percent_Coral_Cover + Year, data = variables)
combined_cc_yr = glm.nb(Combined_Richness ~ Percent_Coral_Cover + Year, data = variables)
# SC + Year (time)
coral_sc_yr = glm.nb(Coral_Richness ~ Percent_Sponge_Cover + Year, data = variables)
sponge_sc_yr = glm.nb(Sponge_Richness ~ Percent_Sponge_Cover + Year, data = variables)
fish_sc_yr = glm.nb(Fish_Richness ~ Percent_Sponge_Cover + Year, data = variables)
combined_sc_yr = glm.nb(Combined_Richness ~ Percent_Sponge_Cover + Year, data = variables)
# R + Year (time)
coral_r_yr = glm.nb(Coral_Richness ~ Rugosity + Year, data = variables)
sponge_r_yr = glm.nb(Sponge_Richness ~ Rugosity + Year, data = variables)
fish_r_yr = glm.nb(Fish_Richness ~ Rugosity + Year, data = variables)
combined_r_yr = glm.nb(Combined_Richness ~ Rugosity + Year, data = variables)
# CC + Site (space)
coral_cc_site = glm.nb(Coral_Richness ~ Percent_Coral_Cover + Site, data = variables)
sponge_cc_site = glm.nb(Sponge_Richness ~ Percent_Coral_Cover + Site, data = variables)
fish_cc_site = glm.nb(Fish_Richness ~ Percent_Coral_Cover + Site, data = variables)
combined_cc_site = glm.nb(Combined_Richness ~ Percent_Coral_Cover + Site, data = variables)
# SC + Site (space)
coral_sc_site = glm.nb(Coral_Richness ~ Percent_Sponge_Cover + Site, data = variables)
sponge_sc_site = glm.nb(Sponge_Richness ~ Percent_Sponge_Cover + Site, data = variables)
fish_sc_site = glm.nb(Fish_Richness ~ Percent_Sponge_Cover + Site, data = variables)
combined_sc_site = glm.nb(Combined_Richness ~ Percent_Sponge_Cover + Site, data = variables)
# R + Site (space)
coral_r_site = glm.nb(Coral_Richness ~ Rugosity + Site, data = variables)
sponge_r_site = glm.nb(Sponge_Richness ~ Rugosity + Site, data = variables)
fish_r_site = glm.nb(Fish_Richness ~ Rugosity + Site, data = variables)
combined_r_site = glm.nb(Combined_Richness ~ Rugosity + Site, data = variables)
# CC + Year + Site
coral_cc_yr_site = glm.nb(Coral_Richness ~ Percent_Coral_Cover + Year + Site, data = variables)
sponge_cc_yr_site = glm.nb(Sponge_Richness ~ Percent_Coral_Cover + Year + Site, data = variables)
fish_cc_yr_site = glm.nb(Fish_Richness ~ Percent_Coral_Cover + Year + Site, data = variables)
combined_cc_yr_site = glm.nb(Combined_Richness ~ Percent_Coral_Cover + Year + Site, data = variables)
# SC + Year + Site
coral_sc_yr_site = glm.nb(Coral_Richness ~ Percent_Sponge_Cover + Year + Site, data = variables)
sponge_sc_yr_site = glm.nb(Sponge_Richness ~ Percent_Sponge_Cover + Year + Site, data = variables)
fish_sc_yr_site = glm.nb(Fish_Richness ~ Percent_Sponge_Cover + Year + Site, data = variables)
combined_sc_yr_site = glm.nb(Combined_Richness ~ Percent_Sponge_Cover + Year + Site, data = variables)
# R + Year + Site
coral_r_yr_site = glm.nb(Coral_Richness ~ Rugosity + Year + Site, data = variables)
sponge_r_yr_site = glm.nb(Sponge_Richness ~ Rugosity + Year + Site, data = variables)
fish_r_yr_site = glm.nb(Fish_Richness ~ Rugosity + Year + Site, data = variables)
combined_r_yr_site = glm.nb(Combined_Richness ~ Rugosity + Year + Site, data = variables)
# CC + Year + Site + YearxSite
coral_cc_yr_site_yrxsite = glm.nb(Coral_Richness ~ Percent_Coral_Cover + Year + Site + Year*Site, data = variables)
sponge_cc_yr_site_yrxsite = glm.nb(Sponge_Richness ~ Percent_Coral_Cover + Year + Site + Year*Site, data = variables)
fish_cc_yr_site_yrxsite = glm.nb(Fish_Richness ~ Percent_Coral_Cover + Year + Site + Year*Site, data = variables)
combined_cc_yr_site_yrxsite = glm.nb(Combined_Richness ~ Percent_Coral_Cover + Year + Site + Year*Site, data = variables)
# SC + Year + Site + YearxSite
coral_sc_yr_site_yrxsite = glm.nb(Coral_Richness ~ Percent_Sponge_Cover + Year + Site + Year*Site, data = variables)
sponge_sc_yr_site_yrxsite = glm.nb(Sponge_Richness ~ Percent_Sponge_Cover + Year + Site + Year*Site, data = variables)
fish_sc_yr_site_yrxsite = glm.nb(Fish_Richness ~ Percent_Sponge_Cover + Year + Site + Year*Site, data = variables)
combined_sc_yr_site_yrxsite = glm.nb(Combined_Richness ~ Percent_Sponge_Cover + Year + Site + Year*Site, data = variables)
# R + Year + Site + YearxSite
coral_r_yr_site_yrxsite = glm.nb(Coral_Richness ~ Rugosity + Year + Site + Year*Site, data = variables)
sponge_r_yr_site_yrxsite = glm.nb(Sponge_Richness ~ Rugosity + Year + Site + Year*Site, data = variables)
fish_r_yr_site_yrxsite = glm.nb(Fish_Richness ~ Rugosity + Year + Site + Year*Site, data = variables)
combined_r_yr_site_yrxsite = glm.nb(Combined_Richness ~ Rugosity + Year + Site + Year*Site, data = variables)
install.packages("sjPlot")
obj_three_modnames <- c("yr", "site", "yr_site", "yr_site_yrxsite",
"cc", "cc_yr", "cc_site", "cc_yr_site", "cc_yr_site_yrxsite",
"sc", "sc_yr", "sc_site", "sc_yr_site", "sc_yr_site_yrxsite",
"r", "r_yr", "r_site", "r_yr_site", "r_yr_site_yrxsite")
coral_all <- aictab(cand.set = list(coral_yr, coral_site, coral_yr_site, coral_yr_site_yrxsite,
coral_cc, coral_cc_yr, coral_cc_site, coral_cc_yr_site, coral_cc_yr_site_yrxsite,
coral_sc, coral_sc_yr, coral_sc_site, coral_sc_yr_site, coral_sc_yr_site_yrxsite,
coral_r, coral_r_yr, coral_r_site, coral_r_yr_site, coral_r_yr_site_yrxsite),
modnames = obj_three_modnames, digits = 4)
### Nicole Keefner
### Master's Thesis: Develop models and figures using variables.csv
#*7* = need on 3/26 OR errors OR extraneous code
## Use *** to search for errors in the code or areas that need more work
## Use ***AIC to search for beginning of AIC code
## Use ***Simple Figures with Models to search for beginning of this figure code
## Use ***Simple Figures for Fish Richness to search for beginning of this figure code
## Use ***Simple Figures for Sponge Richness to search for beginning of this figure code
## Use ***Simple Figures for Coral Richness to search for beginning of this figure code
## Use ***Simple Figures for Combined Richness to search for beginning of this figure code
## Set Working Directory
## Install packages
## Load packages
# First used for model output in HTML table format using function tab_model
library(sjPlot)
# First used for aic function, aictab
library(AICcmodavg)
# First used to make figures using function ggplot
library(ggplot2)
# First used for negative binomial modeling using function glm.nb
library(MASS)
## Import variables.csv dataset
variables <- read.csv("variables.csv", header = T)
# Note that year is treated as type integer and is therefore continuous
# 4 targets: richness of corals, sponges, fishes, and combined
# 3 surrogates: percent coral cover, percent sponge cover, rugosity
# Because there are NA's in the Sponge_Richness column, R will be unable to calculate summary values
# Create subset of data called "sponge_complete" that retains only complete cases for Sponge_Richness
sponge_complete <- variables[complete.cases(variables$Sponge_Richness), ]
# Create dataframe with means and SD's for all variables
avg_name <-c("Percent_Coral_Cover",
"Percent_Sponge_Cover",
"Rugosity",
"Coral_Richness",
"Sponge_Richness",
"Fish_Richness",
"Combined_Richness")
avg_mean <-c(round(mean(variables$Percent_Coral_Cover), digits = 3),
round(mean(variables$Percent_Sponge_Cover), digits = 3),
round(mean(sponge_complete$Rugosity), digits = 3),
round(mean(variables$Coral_Richness), digits = 3),
round(mean(variables$Sponge_Richness), digits = 3),
round(mean(variables$Fish_Richness), digits = 3),
round(mean(sponge_complete$Combined_Richness), digits = 3))
avg_sd <-c(round(sd(variables$Percent_Coral_Cover), digits = 3),
round(sd(variables$Percent_Sponge_Cover), digits = 3),
round(sd(sponge_complete$Rugosity), digits = 3),
round(sd(variables$Coral_Richness), digits = 3),
round(sd(variables$Sponge_Richness), digits = 3),
round(sd(variables$Fish_Richness), digits = 3),
round(sd(sponge_complete$Combined_Richness), digits = 3))
avg_df <- data.frame(avg_name, avg_mean, avg_sd)
# Graph frequency distributions of response variables
hist(variables$Percent_Coral_Cover, breaks = 25)
hist(variables$Percent_Sponge_Cover, breaks = 25)
hist(variables$Rugosity, breaks = 25)
hist(variables$Coral_Richness, breaks = 25)
hist(variables$Sponge_Richness, breaks = 25)
hist(variables$Fish_Richness, breaks = 25)
hist(variables$Combined_Richness, breaks = 25)
########################################################################
### Objective 1: Create models that only include terms for surrogates
### in order to determine which of the 3 candidate surrogates is the best at predicting each target.
# Negative binomial distribution models and aic tables for each target with one surrogate
# For each target, compare models in aic table
coral_cc = glm.nb(formula = Coral_Richness ~ Percent_Coral_Cover, data = variables)
coral_sc = glm.nb(formula = Coral_Richness ~ Percent_Sponge_Cover, data = variables)
coral_r = glm.nb(formula = Coral_Richness ~ Rugosity, data = variables)
coral_surrogate <- aictab(cand.set = list(coral_cc, coral_sc, coral_r), modnames = c("coral_cc", "coral_sc", "coral_r"), digits = 4)
sponge_cc = glm.nb(formula = Sponge_Richness ~ Percent_Coral_Cover, data = variables)
sponge_sc = glm.nb(formula = Sponge_Richness ~ Percent_Sponge_Cover, data = variables)
sponge_r = glm.nb(formula = Sponge_Richness ~ Rugosity, data = variables)
sponge_surrogate <- aictab(cand.set = list(sponge_cc, sponge_sc, sponge_r), modnames = c("sponge_cc", "sponge_sc", "sponge_r"), digits = 4)
fish_cc = glm.nb(formula = Fish_Richness ~ Percent_Coral_Cover, data = variables)
fish_sc = glm.nb(formula = Fish_Richness ~ Percent_Sponge_Cover, data = variables)
fish_r = glm.nb(formula = Fish_Richness ~ Rugosity, data = variables)
fish_surrogate <- aictab(cand.set = list(fish_cc, fish_sc, fish_r), modnames = c("fish_cc", "fish_sc", "fish_r"), digits = 4)
combined_cc = glm.nb(formula = Combined_Richness ~ Percent_Coral_Cover, data = variables)
combined_sc = glm.nb(formula = Combined_Richness ~ Percent_Sponge_Cover, data = variables)
combined_r = glm.nb(formula = Combined_Richness ~ Rugosity, data = variables)
combined_surrogate <- aictab(cand.set = list(combined_cc, combined_sc, combined_r), modnames = c("combined_cc", "combined_sc", "combined_r"), digits = 4)
########################################################################
### Objective 2: Determine if relationships between targets and candidate
### surrogates remain consistent over space and time.
## No surrogates in these models:
# Year (time)
coral_yr = glm.nb(Coral_Richness ~ Year, data = variables)
sponge_yr = glm.nb(Sponge_Richness ~ Year, data = variables)
fish_yr = glm.nb(Fish_Richness ~ Year, data = variables)
combined_yr = glm.nb(Combined_Richness ~ Year, data = variables)
# Site (space)
coral_site = glm.nb(Coral_Richness ~ Site, data = variables)
sponge_site = glm.nb(Sponge_Richness ~ Site, data = variables)
fish_site = glm.nb(Fish_Richness ~ Site, data = variables)
combined_site = glm.nb(Combined_Richness ~ Site, data = variables)
# Year + Site
coral_yr_site = glm.nb(Coral_Richness ~ Year + Site, data = variables)
sponge_yr_site = glm.nb(Sponge_Richness ~ Year + Site, data = variables)
fish_yr_site = glm.nb(Fish_Richness ~ Year + Site, data = variables)
combined_yr_site = glm.nb(Combined_Richness ~ Year + Site, data = variables)
# Year + Site + YearxSite
coral_yr_site_yrxsite = glm.nb(Coral_Richness ~ Year + Site + Year*Site, data = variables)
sponge_yr_site_yrxsite = glm.nb(Sponge_Richness ~ Year + Site + Year*Site, data = variables)
fish_yr_site_yrxsite = glm.nb(Fish_Richness ~ Year + Site + Year*Site, data = variables)
combined_yr_site_yrxsite = glm.nb(Combined_Richness ~ Year + Site + Year*Site, data = variables)
## These models have surrogates:
# CC + Year (time)
coral_cc_yr = glm.nb(Coral_Richness ~ Percent_Coral_Cover + Year, data = variables)
sponge_cc_yr = glm.nb(Sponge_Richness ~ Percent_Coral_Cover + Year, data = variables)
fish_cc_yr = glm.nb(Fish_Richness ~ Percent_Coral_Cover + Year, data = variables)
combined_cc_yr = glm.nb(Combined_Richness ~ Percent_Coral_Cover + Year, data = variables)
# SC + Year (time)
coral_sc_yr = glm.nb(Coral_Richness ~ Percent_Sponge_Cover + Year, data = variables)
sponge_sc_yr = glm.nb(Sponge_Richness ~ Percent_Sponge_Cover + Year, data = variables)
fish_sc_yr = glm.nb(Fish_Richness ~ Percent_Sponge_Cover + Year, data = variables)
combined_sc_yr = glm.nb(Combined_Richness ~ Percent_Sponge_Cover + Year, data = variables)
# R + Year (time)
coral_r_yr = glm.nb(Coral_Richness ~ Rugosity + Year, data = variables)
sponge_r_yr = glm.nb(Sponge_Richness ~ Rugosity + Year, data = variables)
fish_r_yr = glm.nb(Fish_Richness ~ Rugosity + Year, data = variables)
combined_r_yr = glm.nb(Combined_Richness ~ Rugosity + Year, data = variables)
# CC + Site (space)
coral_cc_site = glm.nb(Coral_Richness ~ Percent_Coral_Cover + Site, data = variables)
sponge_cc_site = glm.nb(Sponge_Richness ~ Percent_Coral_Cover + Site, data = variables)
fish_cc_site = glm.nb(Fish_Richness ~ Percent_Coral_Cover + Site, data = variables)
combined_cc_site = glm.nb(Combined_Richness ~ Percent_Coral_Cover + Site, data = variables)
# SC + Site (space)
coral_sc_site = glm.nb(Coral_Richness ~ Percent_Sponge_Cover + Site, data = variables)
sponge_sc_site = glm.nb(Sponge_Richness ~ Percent_Sponge_Cover + Site, data = variables)
fish_sc_site = glm.nb(Fish_Richness ~ Percent_Sponge_Cover + Site, data = variables)
combined_sc_site = glm.nb(Combined_Richness ~ Percent_Sponge_Cover + Site, data = variables)
# R + Site (space)
coral_r_site = glm.nb(Coral_Richness ~ Rugosity + Site, data = variables)
sponge_r_site = glm.nb(Sponge_Richness ~ Rugosity + Site, data = variables)
fish_r_site = glm.nb(Fish_Richness ~ Rugosity + Site, data = variables)
combined_r_site = glm.nb(Combined_Richness ~ Rugosity + Site, data = variables)
# CC + Year + Site
coral_cc_yr_site = glm.nb(Coral_Richness ~ Percent_Coral_Cover + Year + Site, data = variables)
sponge_cc_yr_site = glm.nb(Sponge_Richness ~ Percent_Coral_Cover + Year + Site, data = variables)
fish_cc_yr_site = glm.nb(Fish_Richness ~ Percent_Coral_Cover + Year + Site, data = variables)
combined_cc_yr_site = glm.nb(Combined_Richness ~ Percent_Coral_Cover + Year + Site, data = variables)
# SC + Year + Site
coral_sc_yr_site = glm.nb(Coral_Richness ~ Percent_Sponge_Cover + Year + Site, data = variables)
sponge_sc_yr_site = glm.nb(Sponge_Richness ~ Percent_Sponge_Cover + Year + Site, data = variables)
fish_sc_yr_site = glm.nb(Fish_Richness ~ Percent_Sponge_Cover + Year + Site, data = variables)
combined_sc_yr_site = glm.nb(Combined_Richness ~ Percent_Sponge_Cover + Year + Site, data = variables)
# R + Year + Site
coral_r_yr_site = glm.nb(Coral_Richness ~ Rugosity + Year + Site, data = variables)
sponge_r_yr_site = glm.nb(Sponge_Richness ~ Rugosity + Year + Site, data = variables)
fish_r_yr_site = glm.nb(Fish_Richness ~ Rugosity + Year + Site, data = variables)
combined_r_yr_site = glm.nb(Combined_Richness ~ Rugosity + Year + Site, data = variables)
# CC + Year + Site + YearxSite
coral_cc_yr_site_yrxsite = glm.nb(Coral_Richness ~ Percent_Coral_Cover + Year + Site + Year*Site, data = variables)
sponge_cc_yr_site_yrxsite = glm.nb(Sponge_Richness ~ Percent_Coral_Cover + Year + Site + Year*Site, data = variables)
fish_cc_yr_site_yrxsite = glm.nb(Fish_Richness ~ Percent_Coral_Cover + Year + Site + Year*Site, data = variables)
combined_cc_yr_site_yrxsite = glm.nb(Combined_Richness ~ Percent_Coral_Cover + Year + Site + Year*Site, data = variables)
# SC + Year + Site + YearxSite
coral_sc_yr_site_yrxsite = glm.nb(Coral_Richness ~ Percent_Sponge_Cover + Year + Site + Year*Site, data = variables)
sponge_sc_yr_site_yrxsite = glm.nb(Sponge_Richness ~ Percent_Sponge_Cover + Year + Site + Year*Site, data = variables)
fish_sc_yr_site_yrxsite = glm.nb(Fish_Richness ~ Percent_Sponge_Cover + Year + Site + Year*Site, data = variables)
combined_sc_yr_site_yrxsite = glm.nb(Combined_Richness ~ Percent_Sponge_Cover + Year + Site + Year*Site, data = variables)
# R + Year + Site + YearxSite
coral_r_yr_site_yrxsite = glm.nb(Coral_Richness ~ Rugosity + Year + Site + Year*Site, data = variables)
sponge_r_yr_site_yrxsite = glm.nb(Sponge_Richness ~ Rugosity + Year + Site + Year*Site, data = variables)
fish_r_yr_site_yrxsite = glm.nb(Fish_Richness ~ Rugosity + Year + Site + Year*Site, data = variables)
combined_r_yr_site_yrxsite = glm.nb(Combined_Richness ~ Rugosity + Year + Site + Year*Site, data = variables)
obj_three_modnames <- c("yr", "site", "yr_site", "yr_site_yrxsite",
"cc", "cc_yr", "cc_site", "cc_yr_site", "cc_yr_site_yrxsite",
"sc", "sc_yr", "sc_site", "sc_yr_site", "sc_yr_site_yrxsite",
"r", "r_yr", "r_site", "r_yr_site", "r_yr_site_yrxsite")
coral_all <- aictab(cand.set = list(coral_yr, coral_site, coral_yr_site, coral_yr_site_yrxsite,
coral_cc, coral_cc_yr, coral_cc_site, coral_cc_yr_site, coral_cc_yr_site_yrxsite,
coral_sc, coral_sc_yr, coral_sc_site, coral_sc_yr_site, coral_sc_yr_site_yrxsite,
coral_r, coral_r_yr, coral_r_site, coral_r_yr_site, coral_r_yr_site_yrxsite),
modnames = obj_three_modnames, digits = 4)
View(coral_all)
sponge_all <- aictab(cand.set = list(sponge_yr, sponge_site, sponge_yr_site, sponge_yr_site_yrxsite,
sponge_cc, sponge_cc_yr, sponge_cc_site, sponge_cc_yr_site, sponge_cc_yr_site_yrxsite,
sponge_sc, sponge_sc_yr, sponge_sc_site, sponge_sc_yr_site, sponge_sc_yr_site_yrxsite,
sponge_r, sponge_r_yr, sponge_r_site, sponge_r_yr_site, sponge_r_yr_site_yrxsite),
modnames = obj_three_modnames, digits = 4)
fish_all <- aictab(cand.set = list(fish_yr, fish_site, fish_yr_site, fish_yr_site_yrxsite,
fish_cc, fish_cc_yr, fish_cc_site, fish_cc_yr_site, fish_cc_yr_site_yrxsite,
fish_sc, fish_sc_yr, fish_sc_site, fish_sc_yr_site, fish_sc_yr_site_yrxsite,
fish_r, fish_r_yr, fish_r_site, fish_r_yr_site, fish_r_yr_site_yrxsite),
modnames = obj_three_modnames, digits = 4)
combined_all <- aictab(cand.set = list(combined_yr, combined_site, combined_yr_site, combined_yr_site_yrxsite,
combined_cc, combined_cc_yr, combined_cc_site, combined_cc_yr_site, combined_cc_yr_site_yrxsite,
combined_sc, combined_sc_yr, combined_sc_site, combined_sc_yr_site, combined_sc_yr_site_yrxsite,
combined_r, combined_r_yr, combined_r_site, combined_r_yr_site, combined_r_yr_site_yrxsite),
modnames = obj_three_modnames, digits = 4)
View(combined_all)
View(fish_all)
View(sponge_all)
summary(combined_cc)
summary(sponge_r_yr_site,sponge_yr_site)
summary(coral_cc_yr)
# For sponge richness
summary(sponge_r_yr_site)
summary(sponge_yr_site)
summary(sponge_cc_yr_site)
# For fish richness
summary(fish_site)
summary(fish_r_site)
summary(fish_yr_site)
summary(fish_cc_site)
summary(fish_sc_site)
# For combined richness
summary(combined_cc_yr_site)
