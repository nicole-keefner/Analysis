#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black"))
#
# # Figure 22. Relationship between time and rugosity by site.
# ggplot(data = variables, aes(x = True_Year_Factor, y = Rugosity, group = Site, color = Site)) +
#   geom_line(size = 1.1) +
#   scale_x_discrete(name = "Time (Years)") +
#   scale_y_continuous(name = "Rugosity") +
#   scale_color_manual(values = cb_palette) +
#   theme(text = element_text(size = 18),
#         axis.text.x = element_text(angle = +90, hjust = 0),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black"))
#
# # Figure 23. Relationship between time and coral richness by site.
# ggplot(data = variables, aes(x = True_Year_Factor, y = Coral_Richness, group = Site, color = Site)) +
#   geom_line(size = 1.1) +
#   scale_x_discrete(name = "Time (Years)") +
#   scale_y_continuous(name = "Coral Richness") +
#   scale_color_manual(values = cb_palette) +
#   theme(text = element_text(size = 18),
#         axis.text.x = element_text(angle = +90, hjust = 0),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black"))
#
# # Figure 24. Relationship between time and sponge richness by site.
# ggplot(data = variables, aes(x = True_Year_Factor, y = Sponge_Richness, group = Site, color = Site)) +
#   geom_line(size = 1.1) +
#   scale_x_discrete(name = "Time (Years)") +
#   scale_y_continuous(name = "Sponge Richness") +
#   scale_color_manual(values = cb_palette) +
#   theme(text = element_text(size = 18),
#         axis.text.x = element_text(angle = +90, hjust = 0),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black"))
# # Resulting warning message same as that from figure 2.
# # The gaps are more apparent in these figures because they have lines instead of points.
#
# # Figure 25. Relationship between time and fish richness by site.
# ggplot(data = variables, aes(x = True_Year_Factor, y = Fish_Richness, group = Site, color = Site)) +
#   geom_line(size = 1.1) +
#   scale_x_discrete(name = "Time (Years)") +
#   scale_y_continuous(name = "Fish Richness") +
#   scale_color_manual(values = cb_palette) +
#   theme(text = element_text(size = 18),
#         axis.text.x = element_text(angle = +90, hjust = 0),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black"))
#
# # Figure 26. Relationship between time and combined richness by site.
# ggplot(data = variables, aes(x = True_Year_Factor, y = Combined_Richness, group = Site, color = Site)) +
#   geom_line(size = 1.1) +
#   scale_x_discrete(name = "Time (Years)") +
#   scale_y_continuous(name = "Combined Richness") +
#   scale_color_manual(values = cb_palette) +
#   theme(text = element_text(size = 18),
#         axis.text.x = element_text(angle = +90, hjust = 0),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black"))
# # Resulting warning message same as that from figure 4.
# # The gaps are more apparent in these figures because they have lines instead of points.
#
#
#
# ########################################################################
#
#
#
# ## Figures of basic relationships between time (x) and surrogates/targets (y) by site (panels)
#
# # Figure 27. Relationship between time and coral cover with sites distinguished by panels.
# ggplot(data = variables, aes(x = True_Year, y = Percent_Coral_Cover)) +
#   geom_point(size = 3) +
#   scale_x_continuous(name = "Time (Years)") +
#   scale_y_continuous(name = "Coral Cover (%)") +
#   theme(text = element_text(size = 18),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black")) +
#   facet_wrap(facets = ~ Site)
#
# # Figure 28. Relationship between time and sponge cover with sites distinguished by panels.
# ggplot(data = variables, aes(x = True_Year, y = Percent_Sponge_Cover)) +
#   geom_point(size = 3) +
#   scale_x_continuous(name = "Time (Years)") +
#   scale_y_continuous(name = "Sponge Cover (%)") +
#   theme(text = element_text(size = 18),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black")) +
#   facet_wrap(facets = ~ Site)
#
# # Figure 29. Relationship between time and rugosity with sites distinguished by panels.
# ggplot(data = variables, aes(x = True_Year, y = Rugosity)) +
#   geom_point(size = 3) +
#   scale_x_continuous(name = "Time (Years)") +
#   scale_y_continuous(name = "Rugosity") +
#   theme(text = element_text(size = 18),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black")) +
#   facet_wrap(facets = ~ Site)
#
# # Figure 30. Relationship between time and coral richness with sites distinguished by panels.
# ggplot(data = variables, aes(x = True_Year, y = Coral_Richness)) +
#   geom_point(size = 3) +
#   scale_x_continuous(name = "Time (Years)") +
#   scale_y_continuous(name = "Coral Richness") +
#   theme(text = element_text(size = 18),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black")) +
#   facet_wrap(facets = ~ Site)
#
# # Figure 31. Relationship between time and sponge richness with sites distinguished by panels.
# ggplot(data = variables, aes(x = True_Year, y = Sponge_Richness)) +
#   geom_point(size = 3) +
#   scale_x_continuous(name = "Time (Years)") +
#   scale_y_continuous(name = "Sponge Richness") +
#   theme(text = element_text(size = 18),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black")) +
#   facet_wrap(facets = ~ Site)
# # Resulting warning message same as that from figure 2.
#
# # Figure 32. Relationship between time and fish richness with sites distinguished by panels.
# ggplot(data = variables, aes(x = True_Year, y = Fish_Richness)) +
#   geom_point(size = 3) +
#   scale_x_continuous(name = "Time (Years)") +
#   scale_y_continuous(name = "Fish Richness") +
#   theme(text = element_text(size = 18),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black")) +
#   facet_wrap(facets = ~ Site)
#
# # Figure 33. Relationship between time and combined richness with sites distinguished by panels.
# ggplot(data = variables, aes(x = True_Year, y = Combined_Richness)) +
#   geom_point(size = 3) +
#   scale_x_continuous(name = "Time (Years)") +
#   scale_y_continuous(name = "Combined Richness") +
#   theme(text = element_text(size = 18),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black")) +
#   facet_wrap(facets = ~ Site)
# # Resulting warning message same as that from figure 4.
########################################################################
#######################CORAL RICHNESS###################################
## Figures of competitive models (<2.0 deltaAIC)
# The most parsimonious model for coral richness is coral_cc_yr.
# The function of this model is Coral_Richness ~ Percent_Coral_Cover + Year.
# Create year vector from 0-26 with 100 values each 0.2626 apart
Year <- rep(seq(from = min(variables$Year), to = max(variables$Year), length.out = 100))
# Create coral cover vector from 2.676-61.746 with 100 values 0.596 apart
Percent_Coral_Cover <- rep(seq(from = min(variables$Percent_Coral_Cover), to = max(variables$Percent_Coral_Cover), length.out = 100))
# Make a grid using these vectors (for each Year value, list each value of coral cover)
coral_pred_grid <- expand.grid(Year = Year, Percent_Coral_Cover = Percent_Coral_Cover)
# Add a column for predicted coral richness from these values using the coral_cc_yr model
# Fixed previous issue of richness limits by setting type argument to "response"
coral_pred_grid$Predicted_Coral_Richness <-predict(object = coral_cc_yr, newdata = coral_pred_grid, type = "response")
# Save predictive plot in variable
predicted_coral_plot <- scatterplot3d(x = coral_pred_grid$Year, y = coral_pred_grid$Percent_Coral_Cover, z = coral_pred_grid$Predicted_Coral_Richness,
angle = 60,
color = "dodgerblue",
pch = 1,
xlab = "Time (Year)",
ylab = "Coral Cover (%)",
zlab = "Coral Richness" )
# Figure 34. Relationship between coral cover and coral richness and time shown in 3 dimensions. Negative binomial distribution used.
predicted_coral_plot
# Add a column so the plot will have the true values compared to the predicted
#predicted_coral_plot$points3d(x = variables$Year, y = variables$Percent_Coral_Cover, z = variables$Coral_Richness, pch = 16)
########################################################################
#######################SPONGE RICHNESS##################################
# Pelican Ghut, Grand Ghut, Crab Cove, Muskmelon, Bigelow, White Bay, Monkey Point, and Guana Head
Pelican_Ghut <- variables[which(variables$Site == "pelican"),]
Grand_Ghut <- variables[which(variables$Site == "grand"),]
Crab_Cove <- variables[which(variables$Site == "crab"),]
Muskmelon <- variables[which(variables$Site == "muskN"),]
Bigelow <- variables[which(variables$Site == "bigelow"),]
White_Bay <- variables[which(variables$Site == "white"),]
Monkey_Point <- variables[which(variables$Site == "monkey"),]
Guana_Head <- variables[which(variables$Site == "iguana"),]
Year <- rep(seq(from = min(Pelican_Ghut$Year), to = max(Pelican_Ghut$Year), length.out = 100))
Percent_Coral_Cover <- rep(seq(from = min(Pelican_Ghut$Percent_Coral_Cover), to = max(Pelican_Ghut$Percent_Coral_Cover), length.out = 100))
Site <- variables$Site[which(variables$Site == "pelican")]
combined_pred_grid <- expand.grid(Year = Year, Percent_Coral_Cover = Percent_Coral_Cover, Site = Site)
combined_pred_grid$Predicted_Combined_Richness <-predict(object = combined_cc_yr_site, newdata = combined_pred_grid, type = "response")
predicted_combined_plot <- scatterplot3d(x = combined_pred_grid$Year, y = combined_pred_grid$Percent_Coral_Cover, z = combined_pred_grid$Predicted_Coral_Richness,
angle = 60,
color = cb_palette[1],
pch = 1,
xlab = "Time (Year)",
ylab = "Coral Cover (%)",
zlab = "Combined Richness")
Year <- rep(seq(from = min(Pelican_Ghut$Year), to = max(Pelican_Ghut$Year), length.out = 100))
Percent_Coral_Cover <- rep(seq(from = min(Pelican_Ghut$Percent_Coral_Cover), to = max(Pelican_Ghut$Percent_Coral_Cover), length.out = 100))
Site <- variables$Site[which(variables$Site == "pelican")]
combined_pred_grid <- expand.grid(Year = Year, Percent_Coral_Cover = Percent_Coral_Cover, Site = Site)
combined_pred_grid$Predicted_Combined_Richness <-predict(object = combined_cc_yr_site, newdata = combined_pred_grid, type = "link")
predicted_combined_plot <- scatterplot3d(x = combined_pred_grid$Year, y = combined_pred_grid$Percent_Coral_Cover, z = combined_pred_grid$Predicted_Coral_Richness,
angle = 60,
color = cb_palette[1],
pch = 1,
xlab = "Time (Year)",
ylab = "Coral Cover (%)",
zlab = "Combined Richness")
summary(combined_pred_grid)
Year <- rep(seq(from = min(Pelican_Ghut$Year), to = max(Pelican_Ghut$Year), length.out = 100))
Percent_Coral_Cover <- rep(seq(from = min(Pelican_Ghut$Percent_Coral_Cover), to = max(Pelican_Ghut$Percent_Coral_Cover), length.out = 100))
combined_pred_grid <- expand.grid(Year = Year, Percent_Coral_Cover = Percent_Coral_Cover)
combined_pred_grid$Predicted_Combined_Richness <-predict(object = combined_cc_yr, newdata = combined_pred_grid, type = "response")
predicted_combined_plot <- scatterplot3d(x = combined_pred_grid$Year, y = combined_pred_grid$Percent_Coral_Cover, z = combined_pred_grid$Predicted_Coral_Richness,
angle = 60,
color = cb_palette[1],
pch = 1,
xlab = "Time (Year)",
ylab = "Coral Cover (%)",
zlab = "Combined Richness")
par(mfrow = c(3,3))
Year <- rep(seq(from = min(Pelican_Ghut$Year), to = max(Pelican_Ghut$Year), length.out = 100))
Percent_Coral_Cover <- rep(seq(from = min(Pelican_Ghut$Percent_Coral_Cover), to = max(Pelican_Ghut$Percent_Coral_Cover), length.out = 100))
combined_pred_grid <- expand.grid(Year = Year, Percent_Coral_Cover = Percent_Coral_Cover)
combined_pred_grid$Predicted_Combined_Richness <-predict(object = combined_cc_yr, newdata = combined_pred_grid, type = "response")
predicted_combined_plot <- scatterplot3d(x = combined_pred_grid$Year, y = combined_pred_grid$Percent_Coral_Cover, z = combined_pred_grid$Predicted_Coral_Richness,
angle = 60,
color = cb_palette[1],
pch = 1,
xlab = "Time (Year) - Pelican Ghut",
ylab = "Coral Cover (%)",
zlab = "Combined Richness")
Year <- rep(seq(from = min(Grand_Ghut$Year), to = max(Grand_Ghut$Year), length.out = 100))
Percent_Coral_Cover <- rep(seq(from = min(Grand_Ghut$Percent_Coral_Cover), to = max(Grand_Ghut$Percent_Coral_Cover), length.out = 100))
combined_pred_grid <- expand.grid(Year = Year, Percent_Coral_Cover = Percent_Coral_Cover)
combined_pred_grid$Predicted_Combined_Richness <-predict(object = combined_cc_yr, newdata = combined_pred_grid, type = "response")
predicted_combined_plot <- scatterplot3d(x = combined_pred_grid$Year, y = combined_pred_grid$Percent_Coral_Cover, z = combined_pred_grid$Predicted_Coral_Richness,
angle = 60,
color = cb_palette[2],
pch = 1,
xlab = "Time (Year) - Grand Ghut",
ylab = "Coral Cover (%)",
zlab = "Combined Richness")
Year <- rep(seq(from = min(Crab_Cove$Year), to = max(Crab_Cove$Year), length.out = 100))
Percent_Coral_Cover <- rep(seq(from = min(Crab_Cove$Percent_Coral_Cover), to = max(Crab_Cove$Percent_Coral_Cover), length.out = 100))
combined_pred_grid <- expand.grid(Year = Year, Percent_Coral_Cover = Percent_Coral_Cover)
combined_pred_grid$Predicted_Combined_Richness <-predict(object = combined_cc_yr, newdata = combined_pred_grid, type = "response")
predicted_combined_plot <- scatterplot3d(x = combined_pred_grid$Year, y = combined_pred_grid$Percent_Coral_Cover, z = combined_pred_grid$Predicted_Coral_Richness,
angle = 60,
color = cb_palette[3],
pch = 1,
xlab = "Time (Year) - Crab Cove",
ylab = "Coral Cover (%)",
zlab = "Combined Richness")
Year <- rep(seq(from = min(Muskmelon$Year), to = max(Muskmelon$Year), length.out = 100))
Percent_Coral_Cover <- rep(seq(from = min(Muskmelon$Percent_Coral_Cover), to = max(Muskmelon$Percent_Coral_Cover), length.out = 100))
combined_pred_grid <- expand.grid(Year = Year, Percent_Coral_Cover = Percent_Coral_Cover)
combined_pred_grid$Predicted_Combined_Richness <-predict(object = combined_cc_yr, newdata = combined_pred_grid, type = "response")
predicted_combined_plot <- scatterplot3d(x = combined_pred_grid$Year, y = combined_pred_grid$Percent_Coral_Cover, z = combined_pred_grid$Predicted_Coral_Richness,
angle = 60,
color = cb_palette[4],
pch = 1,
xlab = "Time (Year) - Muskmelon",
ylab = "Coral Cover (%)",
zlab = "Combined Richness")
Year <- rep(seq(from = min(Bigelow$Year), to = max(Bigelow$Year), length.out = 100))
Percent_Coral_Cover <- rep(seq(from = min(Bigelow$Percent_Coral_Cover), to = max(Bigelow$Percent_Coral_Cover), length.out = 100))
combined_pred_grid <- expand.grid(Year = Year, Percent_Coral_Cover = Percent_Coral_Cover)
combined_pred_grid$Predicted_Combined_Richness <-predict(object = combined_cc_yr, newdata = combined_pred_grid, type = "response")
predicted_combined_plot <- scatterplot3d(x = combined_pred_grid$Year, y = combined_pred_grid$Percent_Coral_Cover, z = combined_pred_grid$Predicted_Coral_Richness,
angle = 60,
color = cb_palette[5],
pch = 1,
xlab = "Time (Year)",
ylab = "Coral Cover (%) - Bigelow",
zlab = "Combined Richness")
Year <- rep(seq(from = min(White_Bay$Year), to = max(White_Bay$Year), length.out = 100))
Percent_Coral_Cover <- rep(seq(from = min(White_Bay$Percent_Coral_Cover), to = max(White_Bay$Percent_Coral_Cover), length.out = 100))
combined_pred_grid <- expand.grid(Year = Year, Percent_Coral_Cover = Percent_Coral_Cover)
combined_pred_grid$Predicted_Combined_Richness <-predict(object = combined_cc_yr, newdata = combined_pred_grid, type = "response")
predicted_combined_plot <- scatterplot3d(x = combined_pred_grid$Year, y = combined_pred_grid$Percent_Coral_Cover, z = combined_pred_grid$Predicted_Coral_Richness,
angle = 60,
color = cb_palette[6],
pch = 1,
xlab = "Time (Year) - White Bay",
ylab = "Coral Cover (%)",
zlab = "Combined Richness")
Year <- rep(seq(from = min(Monkey_Point$Year), to = max(Monkey_Point$Year), length.out = 100))
Percent_Coral_Cover <- rep(seq(from = min(Monkey_Point$Percent_Coral_Cover), to = max(Monkey_Point$Percent_Coral_Cover), length.out = 100))
combined_pred_grid <- expand.grid(Year = Year, Percent_Coral_Cover = Percent_Coral_Cover)
combined_pred_grid$Predicted_Combined_Richness <-predict(object = combined_cc_yr, newdata = combined_pred_grid, type = "response")
predicted_combined_plot <- scatterplot3d(x = combined_pred_grid$Year, y = combined_pred_grid$Percent_Coral_Cover, z = combined_pred_grid$Predicted_Coral_Richness,
angle = 60,
color = cb_palette[7],
pch = 1,
xlab = "Time (Year) - Monkey Point",
ylab = "Coral Cover (%)",
zlab = "Combined Richness")
Year <- rep(seq(from = min(Guana_Head$Year), to = max(Guana_Head$Year), length.out = 100))
Percent_Coral_Cover <- rep(seq(from = min(Guana_Head$Percent_Coral_Cover), to = max(Guana_Head$Percent_Coral_Cover), length.out = 100))
combined_pred_grid <- expand.grid(Year = Year, Percent_Coral_Cover = Percent_Coral_Cover)
combined_pred_grid$Predicted_Combined_Richness <-predict(object = combined_cc_yr, newdata = combined_pred_grid, type = "response")
predicted_combined_plot <- scatterplot3d(x = combined_pred_grid$Year, y = combined_pred_grid$Percent_Coral_Cover, z = combined_pred_grid$Predicted_Coral_Richness,
angle = 60,
color = cb_palette[8],
pch = 1,
xlab = "Time (Year) - Guana Head",
ylab = "Coral Cover (%)",
zlab = "Combined Richness")
par(mfrow = c(1,1))
Year <- rep(seq(from = min(Pelican_Ghut$Year), to = max(Pelican_Ghut$Year), length.out = 100))
Percent_Coral_Cover <- rep(seq(from = min(Pelican_Ghut$Percent_Coral_Cover), to = max(Pelican_Ghut$Percent_Coral_Cover), length.out = 100))
combined_pred_grid <- expand.grid(Year = Year, Percent_Coral_Cover = Percent_Coral_Cover)
combined_pred_grid$Predicted_Combined_Richness <-predict(object = combined_cc_yr, newdata = combined_pred_grid, type = "response")
predicted_combined_plot <- scatterplot3d(x = combined_pred_grid$Year, y = combined_pred_grid$Percent_Coral_Cover, z = combined_pred_grid$Predicted_Coral_Richness,
angle = 60,
color = cb_palette[1],
pch = 1,
xlab = "Time (Year) - Pelican Ghut",
ylab = "Coral Cover (%)",
zlab = "Combined Richness",
xlim = c(min(variables$Year), max(variables$Year)),
ylim = c(min(variables$Percent_Coral_Cover), max(variables$Percent_Coral_Cover)),
zlim = c(min(variables$Combined_Richness), max(variables$Combined_Richness)))
Year <- rep(seq(from = min(Pelican_Ghut$Year), to = max(Pelican_Ghut$Year), length.out = 100))
Percent_Coral_Cover <- rep(seq(from = min(Pelican_Ghut$Percent_Coral_Cover), to = max(Pelican_Ghut$Percent_Coral_Cover), length.out = 100))
combined_pred_grid <- expand.grid(Year = Year, Percent_Coral_Cover = Percent_Coral_Cover)
combined_pred_grid$Predicted_Combined_Richness <-predict(object = combined_cc_yr, newdata = combined_pred_grid, type = "response")
predicted_combined_plot <- scatterplot3d(x = combined_pred_grid$Year, y = combined_pred_grid$Percent_Coral_Cover, z = combined_pred_grid$Predicted_Coral_Richness,
angle = 60,
color = cb_palette[1],
pch = 1,
xlab = "Time (Year) - Pelican Ghut",
ylab = "Coral Cover (%)",
zlab = "Combined Richness",
xlim = c(round(min(variables$Year)), round(max(variables$Year))),
ylim = c(round(min(variables$Percent_Coral_Cover)), round(max(variables$Percent_Coral_Cover))),
zlim = c(round(min(variables$Combined_Richness)), round(max(variables$Combined_Richness))))
min(variables$Year)
round(min(variables$Year))
round(min(variables$Percent_Coral_Cover))
min(variables$Percent_Coral_Cover)
Year <- rep(seq(from = min(Pelican_Ghut$Year), to = max(Pelican_Ghut$Year), length.out = 100))
Percent_Coral_Cover <- rep(seq(from = min(Pelican_Ghut$Percent_Coral_Cover), to = max(Pelican_Ghut$Percent_Coral_Cover), length.out = 100))
combined_pred_grid <- expand.grid(Year = Year, Percent_Coral_Cover = Percent_Coral_Cover)
combined_pred_grid$Predicted_Combined_Richness <-predict(object = combined_cc_yr, newdata = combined_pred_grid, type = "response")
predicted_combined_plot <- scatterplot3d(x = combined_pred_grid$Year, y = combined_pred_grid$Percent_Coral_Cover, z = combined_pred_grid$Predicted_Coral_Richness,
angle = 60,
color = cb_palette[1],
pch = 1,
xlab = "Time (Year) - Pelican Ghut",
ylab = "Coral Cover (%)",
zlab = "Combined Richness",
xlim = c(floor(min(variables$Year)), ceiling(max(variables$Year))),
ylim = c(floor(min(variables$Percent_Coral_Cover)), ceiling(max(variables$Percent_Coral_Cover))),
zlim = c(floor(min(variables$Combined_Richness)), ceiling(max(variables$Combined_Richness))))
floor(min(variables$Year))
0
predicted_combined_plot <- scatterplot3d(x = combined_pred_grid$Year, y = combined_pred_grid$Percent_Coral_Cover, z = combined_pred_grid$Predicted_Coral_Richness,
angle = 60,
color = cb_palette[1],
pch = 1,
xlab = "Time (Year) - Pelican Ghut",
ylab = "Coral Cover (%)",
zlab = "Combined Richness",
xlim = c(0, ceiling(max(variables$Year))),
ylim = c(0, ceiling(max(variables$Percent_Coral_Cover))),
zlim = c(0, ceiling(max(variables$Combined_Richness))))
summary(variables$Percent_Coral_Cover)
summary(variables$Combined_Richness)
predicted_combined_plot <- scatterplot3d(x = combined_pred_grid$Year, y = combined_pred_grid$Percent_Coral_Cover, z = combined_pred_grid$Predicted_Coral_Richness,
angle = 60,
color = cb_palette[1],
pch = 1,
xlab = "Time (Year) - Pelican Ghut",
ylab = "Coral Cover (%)",
zlab = "Combined Richness",
xlim = c(0, 26),
ylim = c(0, 65),
zlim = c(0, 75))
summary(combined_pred_grid)
predicted_combined_plot <- scatterplot3d(x = combined_pred_grid$Year, y = combined_pred_grid$Percent_Coral_Cover, z = combined_pred_grid$Predicted_Coral_Richness,
angle = 60,
color = cb_palette[1],
pch = 1,
xlab = "Time (Year) - Pelican Ghut",
ylab = "Coral Cover (%)",
zlab = "Combined Richness",
xlim = c(0, 26),
ylim = c(0, 65),
zlim = c(0, 75))
predicted_combined_plot <- scatterplot3d(x = combined_pred_grid$Year, y = combined_pred_grid$Percent_Coral_Cover, z = combined_pred_grid$Predicted_Coral_Richness,
angle = 60,
color = cb_palette[1],
pch = 1,
xlab = "Time (Year) - Pelican Ghut",
ylab = "Coral Cover (%)",
zlab = "Combined Richness",
xlim = c(0, 30),
ylim = c(0, 70),
zlim = c(0, 80))
Year <- rep(seq(from = min(Pelican_Ghut$Year), to = max(Pelican_Ghut$Year), length.out = 100))
Percent_Coral_Cover <- rep(seq(from = min(Pelican_Ghut$Percent_Coral_Cover), to = max(Pelican_Ghut$Percent_Coral_Cover), length.out = 100))
combined_pred_grid <- expand.grid(Year = Year, Percent_Coral_Cover = Percent_Coral_Cover)
combined_pred_grid$Predicted_Combined_Richness <-predict(object = combined_cc_yr, newdata = combined_pred_grid, type = "response")
predicted_combined_plot <- scatterplot3d(x = combined_pred_grid$Year, y = combined_pred_grid$Percent_Coral_Cover, z = combined_pred_grid$Predicted_Coral_Richness,
angle = 60,
color = cb_palette[1],
pch = 1,
xlab = "Time (Year) - Pelican Ghut",
ylab = "Coral Cover (%)",
zlab = "Combined Richness",
xlim = c(0, 30),
ylim = c(0, 70),
zlim = c(0, 80))
predicted_combined_plot <- scatterplot3d(x = combined_pred_grid$Year, y = combined_pred_grid$Percent_Coral_Cover, z = combined_pred_grid$Predicted_Coral_Richness,
angle = 60,
color = cb_palette[1],
pch = 1,
xlab = "Time (Year) - Pelican Ghut",
ylab = "Coral Cover (%)",
zlab = "Combined Richness")
Year <- rep(seq(from = min(Pelican_Ghut$Year), to = max(Pelican_Ghut$Year), length.out = 100))
summary(Year)
summary(combined_pred_grid)
Year <- rep(seq(from = min(Pelican_Ghut$Year), to = max(Pelican_Ghut$Year), length.out = 100))
Percent_Coral_Cover <- rep(seq(from = min(Pelican_Ghut$Percent_Coral_Cover), to = max(Pelican_Ghut$Percent_Coral_Cover), length.out = 100))
combined_pred_grid <- expand.grid(Year = Year, Percent_Coral_Cover = Percent_Coral_Cover)
combined_pred_grid$Predicted_Combined_Richness <-predict(object = combined_cc_yr, newdata = combined_pred_grid, type = "response")
predicted_combined_plot <- scatterplot3d(x = combined_pred_grid$Year, y = combined_pred_grid$Percent_Coral_Cover, z = combined_pred_grid$Predicted_Coral_Richness,
angle = 60,
color = cb_palette[1],
pch = 1,
xlab = "Time (Year) - Pelican Ghut",
ylab = "Coral Cover (%)",
zlab = "Combined Richness",
xlim = c(0, 30),
ylim = c(0, 70),
zlim = c(0, 80))
summary(combined_pred_grid)
combined_pred_grid$Predicted_Combined_Richness <-predict(object = combined_cc_yr, newdata = combined_pred_grid, type = "link")
predicted_combined_plot <- scatterplot3d(x = combined_pred_grid$Year, y = combined_pred_grid$Percent_Coral_Cover, z = combined_pred_grid$Predicted_Coral_Richness,
angle = 60,
color = cb_palette[1],
pch = 1,
xlab = "Time (Year) - Pelican Ghut",
ylab = "Coral Cover (%)",
zlab = "Combined Richness",
xlim = c(0, 30),
ylim = c(0, 70),
zlim = c(0, 80))
predicted_combined_plot <- scatterplot3d(x = combined_pred_grid$Year, y = combined_pred_grid$Percent_Coral_Cover, z = combined_pred_grid$Predicted_Coral_Richness,
angle = 60,
color = cb_palette[1],
pch = 1,
xlab = "Time (Year) - Pelican Ghut",
ylab = "Coral Cover (%)",
zlab = "Combined Richness")
combined_pred_grid$Predicted_Combined_Richness <-predict(object = combined_cc_yr, newdata = combined_pred_grid, type = "terms")
predicted_combined_plot <- scatterplot3d(x = combined_pred_grid$Year, y = combined_pred_grid$Percent_Coral_Cover, z = combined_pred_grid$Predicted_Coral_Richness,
angle = 60,
color = cb_palette[1],
pch = 1,
xlab = "Time (Year) - Pelican Ghut",
ylab = "Coral Cover (%)",
zlab = "Combined Richness")
combined_cc_yr
predicted_combined_plot <- scatterplot3d(x = combined_pred_grid$Year, y = combined_pred_grid$Percent_Coral_Cover, z = combined_pred_grid$Predicted_Coral_Richness,
angle = 60,
color = cb_palette[1],
pch = 1,
xlab = "Time (Year) - Pelican Ghut",
ylab = "Coral Cover (%)",
zlab = "Combined Richness",
xlim = c(0, 2000),
ylim = c(0, 70),
zlim = c(0, 80))
predicted_combined_plot <- scatterplot3d(x = combined_pred_grid$Year, y = combined_pred_grid$Percent_Coral_Cover, z = combined_pred_grid$Predicted_Coral_Richness,
angle = 60,
color = cb_palette[1],
pch = 1,
xlab = "Time (Year) - Pelican Ghut",
ylab = "Coral Cover (%)",
zlab = "Combined Richness",
xlim = c(0, 5000),
ylim = c(0, 70),
zlim = c(0, 80))
predicted_combined_plot <- scatterplot3d(x = combined_pred_grid$Year, y = combined_pred_grid$Percent_Coral_Cover, z = combined_pred_grid$Predicted_Coral_Richness,
angle = 60,
color = cb_palette[1],
pch = 1,
xlab = "Time (Year) - Pelican Ghut",
ylab = "Coral Cover (%)",
zlab = "Combined Richness")
