sponge_r = glm.nb(formula = Sponge_Richness ~ Rugosity, data = variables)
sponge_surrogate <- aictab(cand.set = list(sponge_cc, sponge_sc, sponge_r), modnames = c("sponge_cc", "sponge_sc", "sponge_r"), digits = 4)
fish_cc = glm.nb(formula = Fish_Richness ~ Percent_Coral_Cover, data = variables)
fish_sc = glm.nb(formula = Fish_Richness ~ Percent_Sponge_Cover, data = variables)
fish_r = glm.nb(formula = Fish_Richness ~ Rugosity, data = variables)
fish_surrogate <- aictab(cand.set = list(fish_cc, fish_sc, fish_r), modnames = c("fish_cc", "fish_sc", "fish_r"), digits = 4)
combined_cc = glm.nb(formula = Combined_Richness ~ Percent_Coral_Cover, data = variables)
combined_sc = glm.nb(formula = Combined_Richness ~ Percent_Sponge_Cover, data = variables)
combined_r = glm.nb(formula = Combined_Richness ~ Rugosity, data = variables)
combined_surrogate <- aictab(cand.set = list(combined_cc, combined_sc, combined_r), modnames = c("combined_cc", "combined_sc", "combined_r"), digits = 4)
########################################################################
### Objective 2: Determine if relationships between targets and candidate
### surrogates remain consistent over space and time.
## No surrogates in these models:
# Year (time)
coral_yr = glm.nb(formula = Coral_Richness ~ Year, data = variables)
sponge_yr = glm.nb(formula = Sponge_Richness ~ Year, data = variables)
fish_yr = glm.nb(formula = Fish_Richness ~ Year, data = variables)
combined_yr = glm.nb(formula = Combined_Richness ~ Year, data = variables)
# Site (space)
coral_site = glm.nb(formula = Coral_Richness ~ Site, data = variables)
sponge_site = glm.nb(formula = Sponge_Richness ~ Site, data = variables)
fish_site = glm.nb(formula = Fish_Richness ~ Site, data = variables)
combined_site = glm.nb(formula = Combined_Richness ~ Site, data = variables)
# Year + Site
coral_yr_site = glm.nb(formula = Coral_Richness ~ Year + Site, data = variables)
sponge_yr_site = glm.nb(formula = Sponge_Richness ~ Year + Site, data = variables)
fish_yr_site = glm.nb(formula = Fish_Richness ~ Year + Site, data = variables)
combined_yr_site = glm.nb(formula = Combined_Richness ~ Year + Site, data = variables)
# Year + Site + YearxSite
coral_yr_site_yrxsite = glm.nb(formula = Coral_Richness ~ Year + Site + Year*Site, data = variables)
sponge_yr_site_yrxsite = glm.nb(formula = Sponge_Richness ~ Year + Site + Year*Site, data = variables)
fish_yr_site_yrxsite = glm.nb(formula = Fish_Richness ~ Year + Site + Year*Site, data = variables)
combined_yr_site_yrxsite = glm.nb(formula = Combined_Richness ~ Year + Site + Year*Site, data = variables)
## These models have surrogates:
# CC + Year (time)
coral_cc_yr = glm.nb(formula = Coral_Richness ~ Percent_Coral_Cover + Year, data = variables)
sponge_cc_yr = glm.nb(formula = Sponge_Richness ~ Percent_Coral_Cover + Year, data = variables)
fish_cc_yr = glm.nb(formula = Fish_Richness ~ Percent_Coral_Cover + Year, data = variables)
combined_cc_yr = glm.nb(formula = Combined_Richness ~ Percent_Coral_Cover + Year, data = variables)
# SC + Year (time)
coral_sc_yr = glm.nb(formula = Coral_Richness ~ Percent_Sponge_Cover + Year, data = variables)
sponge_sc_yr = glm.nb(formula = Sponge_Richness ~ Percent_Sponge_Cover + Year, data = variables)
fish_sc_yr = glm.nb(formula = Fish_Richness ~ Percent_Sponge_Cover + Year, data = variables)
combined_sc_yr = glm.nb(formula = Combined_Richness ~ Percent_Sponge_Cover + Year, data = variables)
# R + Year (time)
coral_r_yr = glm.nb(formula = Coral_Richness ~ Rugosity + Year, data = variables)
sponge_r_yr = glm.nb(formula = Sponge_Richness ~ Rugosity + Year, data = variables)
fish_r_yr = glm.nb(formula = Fish_Richness ~ Rugosity + Year, data = variables)
combined_r_yr = glm.nb(formula = Combined_Richness ~ Rugosity + Year, data = variables)
# CC + Site (space)
coral_cc_site = glm.nb(formula = Coral_Richness ~ Percent_Coral_Cover + Site, data = variables)
sponge_cc_site = glm.nb(formula = Sponge_Richness ~ Percent_Coral_Cover + Site, data = variables)
fish_cc_site = glm.nb(formula = Fish_Richness ~ Percent_Coral_Cover + Site, data = variables)
combined_cc_site = glm.nb(formula = Combined_Richness ~ Percent_Coral_Cover + Site, data = variables)
# SC + Site (space)
coral_sc_site = glm.nb(formula = Coral_Richness ~ Percent_Sponge_Cover + Site, data = variables)
sponge_sc_site = glm.nb(formula = Sponge_Richness ~ Percent_Sponge_Cover + Site, data = variables)
fish_sc_site = glm.nb(formula = Fish_Richness ~ Percent_Sponge_Cover + Site, data = variables)
combined_sc_site = glm.nb(formula = Combined_Richness ~ Percent_Sponge_Cover + Site, data = variables)
# R + Site (space)
coral_r_site = glm.nb(formula = Coral_Richness ~ Rugosity + Site, data = variables)
sponge_r_site = glm.nb(formula = Sponge_Richness ~ Rugosity + Site, data = variables)
fish_r_site = glm.nb(formula = Fish_Richness ~ Rugosity + Site, data = variables)
combined_r_site = glm.nb(formula = Combined_Richness ~ Rugosity + Site, data = variables)
# CC + Year + Site
coral_cc_yr_site = glm.nb(formula = Coral_Richness ~ Percent_Coral_Cover + Year + Site, data = variables)
sponge_cc_yr_site = glm.nb(formula = Sponge_Richness ~ Percent_Coral_Cover + Year + Site, data = variables)
fish_cc_yr_site = glm.nb(formula = Fish_Richness ~ Percent_Coral_Cover + Year + Site, data = variables)
combined_cc_yr_site = glm.nb(formula = Combined_Richness ~ Percent_Coral_Cover + Year + Site, data = variables)
# SC + Year + Site
coral_sc_yr_site = glm.nb(formula = Coral_Richness ~ Percent_Sponge_Cover + Year + Site, data = variables)
sponge_sc_yr_site = glm.nb(formula = Sponge_Richness ~ Percent_Sponge_Cover + Year + Site, data = variables)
fish_sc_yr_site = glm.nb(formula = Fish_Richness ~ Percent_Sponge_Cover + Year + Site, data = variables)
combined_sc_yr_site = glm.nb(formula = Combined_Richness ~ Percent_Sponge_Cover + Year + Site, data = variables)
# R + Year + Site
coral_r_yr_site = glm.nb(formula = Coral_Richness ~ Rugosity + Year + Site, data = variables)
sponge_r_yr_site = glm.nb(formula = Sponge_Richness ~ Rugosity + Year + Site, data = variables)
fish_r_yr_site = glm.nb(formula = Fish_Richness ~ Rugosity + Year + Site, data = variables)
combined_r_yr_site = glm.nb(formula = Combined_Richness ~ Rugosity + Year + Site, data = variables)
# # The following models are not included in AIC tables or interpretations
# # CC + Year + Site + YearxSite
# coral_cc_yr_site_yrxsite = glm.nb(formula = Coral_Richness ~ Percent_Coral_Cover + Year + Site + Year*Site, data = variables)
# sponge_cc_yr_site_yrxsite = glm.nb(formula = Sponge_Richness ~ Percent_Coral_Cover + Year + Site + Year*Site, data = variables)
# fish_cc_yr_site_yrxsite = glm.nb(formula = Fish_Richness ~ Percent_Coral_Cover + Year + Site + Year*Site, data = variables)
# combined_cc_yr_site_yrxsite = glm.nb(formula = Combined_Richness ~ Percent_Coral_Cover + Year + Site + Year*Site, data = variables)
# # SC + Year + Site + YearxSite
# coral_sc_yr_site_yrxsite = glm.nb(formula = Coral_Richness ~ Percent_Sponge_Cover + Year + Site + Year*Site, data = variables)
# sponge_sc_yr_site_yrxsite = glm.nb(formula = Sponge_Richness ~ Percent_Sponge_Cover + Year + Site + Year*Site, data = variables)
# fish_sc_yr_site_yrxsite = glm.nb(formula = Fish_Richness ~ Percent_Sponge_Cover + Year + Site + Year*Site, data = variables)
# combined_sc_yr_site_yrxsite = glm.nb(formula = Combined_Richness ~ Percent_Sponge_Cover + Year + Site + Year*Site, data = variables)
# # R + Year + Site + YearxSite
# coral_r_yr_site_yrxsite = glm.nb(formula = Coral_Richness ~ Rugosity + Year + Site + Year*Site, data = variables)
# sponge_r_yr_site_yrxsite = glm.nb(formula = Sponge_Richness ~ Rugosity + Year + Site + Year*Site, data = variables)
# fish_r_yr_site_yrxsite = glm.nb(formula = Fish_Richness ~ Rugosity + Year + Site + Year*Site, data = variables)
# combined_r_yr_site_yrxsite = glm.nb(formula = Combined_Richness ~ Rugosity + Year + Site + Year*Site, data = variables)
modavgPred(cand.set = sponge_yr_site, type = "response")
modavgPred(cand.set = sponge_yr_site, type = "response")
modavgPred(sponge_yr_site, type = "response")
newdata <- data.frame(
yr = rep(seq(from = min(variables$Year), to = max(variables$Year), length.out = 100), 3), #3?
site = factor(rep(1:8, each = 100), levels = 1:8, labels =
levels(variables$Site)))
newdata2 <- cbind(newdata2, predict(m1, newdata2, type = "link", se.fit=TRUE))
newdata <- data.frame(
yr = rep(seq(from = min(variables$Year), to = max(variables$Year), length.out = 100), 8), #3?
site = factor(rep(1:8, each = 100), levels = 1:8, labels =
levels(variables$Site)))
View(newdata)
View(newdata)
ggplot(data = newdata, aes(x = yr, y = Predicted_Sponge_Richness)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = prog), alpha = 0.25) +
geom_line(aes(color = prog), size = 2) +
labs(x = "Time (Year)", y = "Predicted Sponge Richness")
newdata <- data.frame(
yr = rep(seq(from = min(variables$Year), to = max(variables$Year), length.out = 100), 8), #3?
site = factor(rep(1:8, each = 100), levels = 1:8, labels =
levels(variables$Site)))
newdata <- cbind(newdata, predict(sponge_yr_site, newdata, type = "link", se.fit = TRUE))
newdata <- within(newdata, {
Predicted_Sponge_Richness <- exp(fit)
LL <- exp(fit - 1.96 * se.fit)
UL <- exp(fit + 1.96 * se.fit)
})
newdata <- data.frame(
yr = rep(seq(from = min(variables$Year), to = max(variables$Year), length.out = 100), 8), #3?
site = factor(rep(1:8, each = 100), levels = 1:8, labels =
levels(variables$Site)))
newdata <- cbind(newdata, predict(sponge_yr_site, newdata, type = "link", se.fit = TRUE))
newdata <- data.frame(
Year = rep(seq(from = min(variables$Year), to = max(variables$Year), length.out = 100), 8), #3?
Site = factor(rep(1:8, each = 100), levels = 1:8, labels =
levels(variables$Site)))
newdata <- cbind(newdata, predict(sponge_yr_site, newdata, type = "link", se.fit = TRUE))
newdata <- within(newdata, {
Predicted_Sponge_Richness <- exp(fit)
LL <- exp(fit - 1.96 * se.fit)
UL <- exp(fit + 1.96 * se.fit)
})
ggplot(data = newdata, aes(x = yr, y = Predicted_Sponge_Richness)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = prog), alpha = 0.25) +
geom_line(aes(color = prog), size = 2) +
labs(x = "Time (Year)", y = "Predicted Sponge Richness")
ggplot(data = newdata, aes(x = yr, y = Predicted_Sponge_Richness)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Site), alpha = 0.25) +
geom_line(aes(color = Site), size = 2) +
labs(x = "Time (Year)", y = "Predicted Sponge Richness")
ggplot(data = newdata, aes(x = Year, y = Predicted_Sponge_Richness)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Site), alpha = 0.25) +
geom_line(aes(color = Site), size = 2) +
labs(x = "Time (Year)", y = "Predicted Sponge Richness")
View(newdata)
ggplot(variables, aes(x = Coral_Richness, y = Sponge_Richness)) +
geom_point(aes(color = True_Year), size = 3) +
scale_x_continuous(name = "Coral Richness") +
scale_y_continuous(name = "Sponge Richness") +
scale_color_gradient(low="lightblue", high="darkblue") +
theme(text=element_text(size = 18),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black")) +
facet_wrap(~ Site)
ggplot(data = newdata, aes(x = Year, y = Predicted_Sponge_Richness)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Site), alpha = 0.25) +
geom_line(aes(color = Site), size = 2) +
labs(x = "Time (Year)", y = "Predicted Sponge Richness") +
geom_point(aes(color = True_Year), size = 3)
ggplot(data = newdata, aes(x = Year, y = Predicted_Sponge_Richness)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Site), alpha = 0.25) +
geom_line(aes(color = Site), size = 2) +
labs(x = "Time (Year)", y = "Predicted Sponge Richness") +
geom_point(aes(color = variables$True_Year), size = 3)
ggplot(data = newdata, aes(x = Year, y = Predicted_Sponge_Richness)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Site), alpha = 0.25) +
geom_line(aes(color = Site), size = 2) +
labs(x = "Time (Year)", y = "Predicted Sponge Richness")
ggplot(data = newdata, aes(x = Year, y = Predicted_Sponge_Richness)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Site), alpha = 0.25) +
geom_line(aes(color = Site), size = 2) +
labs(x = "Time (Year)", y = "Predicted Sponge Richness") +
theme(text=element_text(size = 18),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(data = newdata, aes(x = Year, y = Predicted_Sponge_Richness)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Site), alpha = 0.25) +
geom_line(aes(color = Site), size = 2) +
labs(x = "Time (Year)", y = "Predicted Sponge Richness") +
scale_color_manual(values = cb_palette) +
theme(text=element_text(size = 18),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(variables, aes(x = Coral_Richness, y = Sponge_Richness)) +
geom_point(aes(color = True_Year), size = 3) +
scale_x_continuous(name = "Coral Richness") +
scale_y_continuous(name = "Sponge Richness") +
scale_color_gradient(low="lightblue", high="darkblue") +
theme(text=element_text(size = 18),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(variables, aes(x = Rugosity, y = Sponge_Richness)) +
geom_point(size = 3)+
scale_x_continuous(name ="Rugosity") +
scale_y_continuous(name ="Sponge Richness") +
geom_smooth(size = 1.2, method = "glm.nb", formula = y ~ x, aes(color = "Linear")) +
#geom_smooth(size = 1.2, method = "glm.nb", formula = y ~ log(x), aes(color = "Logarithmic")) +
#geom_smooth(size = 1.2, method = "glm.nb", formula = y ~ exp(3.4258 + -0.1012*log(x)), aes(color = "Power")) +
scale_colour_manual(name = "Models", values = c("blue", "red", "green")) +
theme(text=element_text(size=27),
panel.grid.major = element_line(colour="light gray", size = (0.5)),
panel.grid.minor = element_line(colour="light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(variables, aes(x = Year, y = Sponge_Richness)) +
geom_point(size = 3)+
scale_x_continuous(name ="Time (Years)") +
scale_y_continuous(name ="Sponge Richness") +
geom_smooth(size = 1.2, method = "glm.nb", formula = y ~ x, aes(color = "Linear")) +
#geom_smooth(size = 1.2, method = "glm.nb", formula = y ~ log(x), aes(color = "Logarithmic")) +
#geom_smooth(size = 1.2, method = "glm.nb", formula = y ~ exp(3.4258 + -0.1012*log(x)), aes(color = "Power")) +
scale_colour_manual(name = "Models", values = c("blue", "red", "green")) +
theme(text=element_text(size=27),
panel.grid.major = element_line(colour="light gray", size = (0.5)),
panel.grid.minor = element_line(colour="light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(variables, aes(x = Coral_Richness, y = Sponge_Richness)) +
geom_point(aes(color = True_Year), size = 3) +
scale_x_continuous(name = "Coral Richness") +
scale_y_continuous(name = "Sponge Richness") +
scale_color_gradient(low="lightblue", high="darkblue") +
theme(text=element_text(size = 18),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(data = newdata, aes(x = Year, y = Predicted_Sponge_Richness)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Site), alpha = 0.25) +
geom_line(aes(color = Site), size = 2) +
labs(x = "Time (Year)", y = "Predicted Sponge Richness") +
scale_color_manual(values = cb_palette) +
theme(text = element_text(size = 18),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(variables, aes(x = Year, y = Sponge_Richness)) +
geom_point(size = 3)+
scale_x_continuous(name ="Time (Years)") +
scale_y_continuous(name ="Sponge Richness") +
geom_smooth(size = 1.2, method = "glm.nb", formula = y ~ x, aes(color = "Linear")) +
scale_colour_manual(name = "Models", values = c("blue", "red", "green")) +
theme(text=element_text(size=27),
panel.grid.major = element_line(colour="light gray", size = (0.5)),
panel.grid.minor = element_line(colour="light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(variables, aes(x = Year, y = Sponge_Richness)) +
geom_point(size = 3)+
scale_x_continuous(name ="Time (Year)") +
scale_y_continuous(name ="Sponge Richness") +
geom_smooth(size = 1.2, method = "glm.nb", formula = y ~ x + Site, aes(color = "Linear")) +
scale_colour_manual(name = "Models", values = c("blue", "red", "green")) +
theme(text=element_text(size=27),
panel.grid.major = element_line(colour="light gray", size = (0.5)),
panel.grid.minor = element_line(colour="light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(variables, aes(x = Year, y = Sponge_Richness)) +
geom_point(size = 3)+
scale_x_continuous(name ="Time (Year)") +
scale_y_continuous(name ="Sponge Richness") +
geom_smooth(size = 1.2, method = "glm.nb", formula = y ~ x, aes(color = Site)) +
scale_colour_manual(name = "Models", values = c("blue", "red", "green")) +
theme(text=element_text(size=27),
panel.grid.major = element_line(colour="light gray", size = (0.5)),
panel.grid.minor = element_line(colour="light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(variables, aes(x = Year, y = Sponge_Richness)) +
geom_point(size = 3)+
scale_x_continuous(name ="Time (Year)") +
scale_y_continuous(name ="Sponge Richness") +
geom_smooth(size = 1.2, method = "glm.nb", formula = y ~ x, aes(color = Site)) +
scale_color_manual(values = cb_palette) +
theme(text=element_text(size=27),
panel.grid.major = element_line(colour="light gray", size = (0.5)),
panel.grid.minor = element_line(colour="light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(data = newdata, aes(x = Year, y = Predicted_Sponge_Richness)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Site), alpha = 0.25) +
geom_line(aes(color = Site), size = 2) +
labs(x = "Time (Year)", y = "Predicted Sponge Richness") +
scale_color_manual(values = cb_palette) +
theme(text = element_text(size = 18),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(variables, aes(x = Year, y = Sponge_Richness)) +
geom_point(size = 3)+
scale_x_continuous(name ="Time (Year)") +
scale_y_continuous(name ="Sponge Richness") +
geom_smooth(size = 1.2, method = "glm.nb", formula = y ~ x, aes(color = Site)) +
scale_color_manual(values = cb_palette) +
theme(text=element_text(size=27),
panel.grid.major = element_line(colour="light gray", size = (0.5)),
panel.grid.minor = element_line(colour="light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(variables, aes(x = Year, y = Sponge_Richness)) +
geom_point(size = 3)+
scale_x_continuous(name ="Time (Year)") +
scale_y_continuous(name ="Sponge Richness") +
geom_smooth(size = 1.2, method = "glm.nb", formula = Sponge_Richness ~ Year + Site, aes(color = Site)) +
scale_color_manual(values = cb_palette) +
theme(text=element_text(size=27),
panel.grid.major = element_line(colour="light gray", size = (0.5)),
panel.grid.minor = element_line(colour="light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(variables, aes(x = Year, y = Sponge_Richness)) +
geom_point(size = 3)+
scale_x_continuous(name ="Time (Year)") +
scale_y_continuous(name ="Sponge Richness") +
geom_smooth(size = 1.2, method = "glm.nb", formula = y ~ x, aes(color = Site)) +
scale_color_manual(values = cb_palette) +
theme(text=element_text(size=27),
panel.grid.major = element_line(colour="light gray", size = (0.5)),
panel.grid.minor = element_line(colour="light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(data = variables, aes(x = True_Year_Factor, y = Sponge_Richness, group = Site, color = Site)) +
geom_point(size = 3) +
scale_x_discrete(name = "Time (Years)") +
scale_y_continuous(name = "Sponge Richness") +
theme(text = element_text(size = 18),
axis.text.x = element_text(angle = +90, hjust = 0),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
variables$True_Year_Factor <- as.factor(x = variables$True_Year)
variables$True_Year_Numeric <- as.numeric(x = variables$True_Year)
cb_palette <- c("#999999", "#E69F00", "#56B4E9", "#009E73",
"#F0E442", "#0072B2", "#D55E00", "#CC79A7")
ggplot(data = variables, aes(x = True_Year_Factor, y = Sponge_Richness, group = Site, color = Site)) +
geom_point(size = 3) +
scale_x_discrete(name = "Time (Years)") +
scale_y_continuous(name = "Sponge Richness") +
theme(text = element_text(size = 18),
axis.text.x = element_text(angle = +90, hjust = 0),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(data = sponge_predictions, aes(x = Year, y = Predicted_Sponge_Richness)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Site), alpha = 0.25) +
geom_line(aes(color = Site), size = 2) +
labs(x = "Time (Year)", y = "Predicted Sponge Richness") +
scale_color_manual(values = cb_palette) +
theme(text = element_text(size = 18),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
## Figures of competitive models (<2.0 deltaAIC)
# The most parsimonious model for sponge richness is sponge_yr_site.
# The function of this model is Sponge_Richness ~ Year + Site.
# Create new dataframe of predicted values from this model
sponge_predictions <- data.frame(
Year = rep(seq(from = min(variables$Year), to = max(variables$Year), length.out = 100), 8),
Site = factor(rep(1:8, each = 100), levels = 1:8, labels =
levels(variables$Site)))
sponge_predictions <- cbind(sponge_predictions, predict(sponge_yr_site, sponge_predictions, type = "link", se.fit = TRUE))
sponge_predictions <- within(sponge_predictions, {
Predicted_Sponge_Richness <- exp(fit)
LL <- exp(fit - 1.96 * se.fit)
UL <- exp(fit + 1.96 * se.fit)
})
# Figure 35. Relationship between time and sponge richness by site. Negative binomial distribution used.***
ggplot(data = sponge_predictions, aes(x = Year, y = Predicted_Sponge_Richness)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Site), alpha = 0.25) +
geom_line(aes(color = Site), size = 2) +
labs(x = "Time (Year)", y = "Predicted Sponge Richness") +
scale_color_manual(values = cb_palette) +
theme(text = element_text(size = 18),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(data = variables, aes(x = Year, y = Sponge_Richness)) +
geom_point(size = 3)+
scale_x_continuous(name = "Time (Year)") +
scale_y_continuous(name = "Sponge Richness") +
geom_smooth(size = 1.2, method = "glm.nb", formula = y ~ x, aes(color = Site)) +
scale_color_manual(values = cb_palette) +
theme(text = element_text(size=27),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
fish_predictions <- cbind(sponge_predictions, predict(fish_site, sponge_predictions, type = "link", se.fit = TRUE))
fish_predictions <- within(fish_predictions, {
Predicted_Fish_Richness <- exp(fit)
LL <- exp(fit - 1.96 * se.fit)
UL <- exp(fit + 1.96 * se.fit)
})
fish_predictions <- data.frame(
Year = rep(seq(from = min(variables$Year), to = max(variables$Year), length.out = 100), 8),
Site = factor(rep(1:8, each = 100), levels = 1:8, labels =
levels(variables$Site)))
sponge_predictions <- cbind(fish_predictions, predict(fish_site, fish_predictions, type = "link", se.fit = TRUE))
sponge_predictions <- within(fish_predictions, {
Predicted_Sponge_Richness <- exp(fit)
LL <- exp(fit - 1.96 * se.fit)
UL <- exp(fit + 1.96 * se.fit)
})
ggplot(data = sponge_predictions, aes(x = Year, y = Predicted_Sponge_Richness)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Site), alpha = 0.25) +
geom_line(aes(color = Site), size = 2) +
labs(x = "Time (Year)", y = "Predicted Sponge Richness") +
scale_color_manual(values = cb_palette) +
theme(text = element_text(size = 18),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
fish_predictions <- data.frame(
Year = rep(seq(from = min(variables$Year), to = max(variables$Year), length.out = 100), 8),
Site = factor(rep(1:8, each = 100), levels = 1:8, labels =
levels(variables$Site)))
fish_predictions <- cbind(fish_predictions, predict(fish_site, fish_predictions, type = "link", se.fit = TRUE))
fish_predictions <- within(fish_predictions, {
Predicted_Fish_Richness <- exp(fit)
LL <- exp(fit - 1.96 * se.fit)
UL <- exp(fit + 1.96 * se.fit)
})
ggplot(data = fish_predictions, aes(x = Year, y = Predicted_Fish_Richness)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Site), alpha = 0.25) +
geom_line(aes(color = Site), size = 2) +
labs(x = "Time (Year)", y = "Predicted Fish Richness") +
scale_color_manual(values = cb_palette) +
theme(text = element_text(size = 18),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(data = variables, aes(x = Year, y = Fish_Richness)) +
geom_point(size = 3)+
scale_x_continuous(name = "Time (Year)") +
scale_y_continuous(name = "Fish Richness") +
geom_smooth(size = 1.2, method = "glm.nb", formula = y ~ x, aes(color = Site)) +
scale_color_manual(values = cb_palette) +
theme(text = element_text(size=27),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(data = variables, aes(x = Year, y = Coral_Richness, z = Percent_Coral_Cover)) +
geom_point(size = 3)+
scale_x_continuous(name = "Time (Year)") +
scale_y_continuous(name = "Fish Richness") +
geom_smooth(size = 1.2, method = "glm.nb", formula = y ~ x, aes(color = Site)) +
scale_color_manual(values = cb_palette) +
theme(text = element_text(size=27),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(data = variables, aes(x = Year, y = Coral_Richness, z = Percent_Coral_Cover)) +
geom_point(size = 3)+
scale_x_continuous(name = "Time (Year)") +
scale_y_continuous(name = "Coral Richness") +
scale_z_continuous(name = "Coral Cover (%)") +
geom_smooth(size = 1.2, method = "glm.nb", formula = y ~ x + z) +
theme(text = element_text(size=27),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(data = variables, aes(x = Year, y = Coral_Richness, z = Percent_Coral_Cover)) +
geom_point(size = 3)+
scale_x_continuous(name = "Time (Year)") +
scale_y_continuous(name = "Coral Richness") +
geom_smooth(size = 1.2, method = "glm.nb", formula = y ~ x + z) +
theme(text = element_text(size=27),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(data = variables, aes(x = Year, y = Coral_Richness, z = Percent_Coral_Cover)) +
geom_point(size = 3)+
scale_x_continuous(name = "Time (Year)") +
scale_y_continuous(name = "Coral Richness") +
axes_3D() +
stat_3D() +
theme(text = element_text(size=27),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
?axes_3D
??axes_3D
install.packages("gg3D")
