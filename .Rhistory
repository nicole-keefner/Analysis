#                     theme(text = element_text(size = 27),
#                           panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#                           panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#                           panel.background = element_blank(),
#                           axis.line = element_line(colour = "black"))
#
# # Figure 2. Relationship between coral cover and sponge richness.
# basic_sponge_cc <- ggplot(data = variables, aes(x = Percent_Coral_Cover, y = Sponge_Richness)) +
#                     geom_point(size = 3) +
#                     scale_x_continuous(name = "Coral Cover (%)") +
#                     scale_y_continuous(name = "Sponge Richness") +
#                     theme(text = element_text(size = 27),
#                           panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#                           panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#                           panel.background = element_blank(),
#                           axis.line = element_line(colour = "black"))
# # Resulting warning message just lets you know that there are years and sites for which these data are unavailable.
# # This does not change the resulting plot except that it will have fewer points than similar plots.
#
# # Figure 3. Relationship between coral cover and fish richness.
# basic_fish_cc <- ggplot(data = variables, aes(x = Percent_Coral_Cover, y = Fish_Richness)) +
#                   geom_point(size = 3) +
#                   scale_x_continuous(name = "Coral Cover (%)") +
#                   scale_y_continuous(name = "Fish Richness") +
#                   theme(text = element_text(size = 27),
#                         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#                         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#                         panel.background = element_blank(),
#                         axis.line = element_line(colour = "black"))
#
# # Figure 4. Relationship between coral cover and combined richness.
# basic_combined_cc <- ggplot(data = variables, aes(x = Percent_Coral_Cover, y = Combined_Richness)) +
#                     geom_point(size = 3) +
#                     scale_x_continuous(name = "Coral Cover (%)") +
#                     scale_y_continuous(name = "Combined Richness") +
#                     theme(text = element_text(size = 27),
#                           panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#                           panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#                           panel.background = element_blank(),
#                           axis.line = element_line(colour = "black"))
# # Resulting warning message similar to that from figure 2.
# # Combined richness was only calculated for sites and years when richness was recorded for all 3 groups.
#
# # Figure 5. Relationship between sponge cover and coral richness.
# basic_coral_sc <- ggplot(data = variables, aes(x = Percent_Sponge_Cover, y = Coral_Richness)) +
#                     geom_point(size = 3) +
#                     scale_x_continuous(name = "Sponge Cover (%)") +
#                     scale_y_continuous(name = "Coral Richness") +
#                     theme(text = element_text(size = 27),
#                           panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#                           panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#                           panel.background = element_blank(),
#                           axis.line = element_line(colour = "black"))
#
# # Figure 6. Relationship between sponge cover and sponge richness.
# basic_sponge_sc <- ggplot(data = variables, aes(x = Percent_Sponge_Cover, y = Sponge_Richness)) +
#                       geom_point(size = 3) +
#                       scale_x_continuous(name = "Sponge Cover (%)") +
#                       scale_y_continuous(name = "Sponge Richness") +
#                       theme(text = element_text(size = 27),
#                             panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#                             panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#                             panel.background = element_blank(),
#                             axis.line = element_line(colour = "black"))
# # Resulting warning message same as that from figure 2.
#
# # Figure 7. Relationship between sponge cover and fish richness.
# basic_fish_sc <- ggplot(data = variables, aes(x = Percent_Sponge_Cover, y = Fish_Richness)) +
#                     geom_point(size = 3) +
#                     scale_x_continuous(name = "Sponge Cover (%)") +
#                     scale_y_continuous(name = "Fish Richness") +
#                     theme(text = element_text(size = 27),
#                           panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#                           panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#                           panel.background = element_blank(),
#                           axis.line = element_line(colour = "black"))
#
# # Figure 8. Relationship between sponge cover and combined richness.
# basic_combined_sc <- ggplot(data = variables, aes(x = Percent_Sponge_Cover, y = Combined_Richness)) +
#                         geom_point(size = 3) +
#                         scale_x_continuous(name = "Sponge Cover (%)") +
#                         scale_y_continuous(name = "Combined Richness") +
#                         theme(text = element_text(size = 27),
#                               panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#                               panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#                               panel.background = element_blank(),
#                               axis.line = element_line(colour = "black"))
# # Resulting warning message same as that from figure 4.
#
# # Figure 9. Relationship between rugosity and coral richness.
# basic_coral_r <- ggplot(data = variables, aes(x = Rugosity, y = Coral_Richness)) +
#                     geom_point(size = 3) +
#                     scale_x_continuous(name = "Rugosity") +
#                     scale_y_continuous(name = "Coral Richness") +
#                     theme(text = element_text(size = 27),
#                           panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#                           panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#                           panel.background = element_blank(),
#                           axis.line = element_line(colour = "black"))
#
# # Figure 10. Relationship between rugosity and sponge richness.
# basic_sponge_r <- ggplot(data = variables, aes(x = Rugosity, y = Sponge_Richness)) +
#                     geom_point(size = 3) +
#                     scale_x_continuous(name = "Rugosity") +
#                     scale_y_continuous(name = "Sponge Richness") +
#                     theme(text = element_text(size = 27),
#                           panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#                           panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#                           panel.background = element_blank(),
#                           axis.line = element_line(colour = "black"))
# # Resulting warning message same as that from figure 2.
#
# # Figure 11. Relationship between rugosity and fish richness.
# basic_fish_r <- ggplot(data = variables, aes(x = Rugosity, y = Fish_Richness)) +
#                   geom_point(size = 3) +
#                   scale_x_continuous(name = "Rugosity") +
#                   scale_y_continuous(name = "Fish Richness") +
#                   theme(text = element_text(size = 27),
#                         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#                         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#                         panel.background = element_blank(),
#                         axis.line = element_line(colour = "black"))
#
# # Figure 12. Relationship between rugosity and combined richness.
# basic_combined_r <- ggplot(data = variables, aes(x = Rugosity, y = Combined_Richness)) +
#                       geom_point(size = 3) +
#                       scale_x_continuous(name = "Rugosity") +
#                       scale_y_continuous(name = "Combined Richness") +
#                       theme(text = element_text(size = 27),
#                             panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#                             panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#                             panel.background = element_blank(),
#                             axis.line = element_line(colour = "black"))
# # Resulting warning message same as that from figure 4.
#
# # Organize all of these figures into one window for objective 1
# grid.arrange(basic_coral_cc, basic_coral_sc, basic_coral_r,
#              basic_sponge_cc, basic_sponge_sc, basic_sponge_r,
#              basic_fish_cc, basic_fish_sc, basic_fish_r,
#              basic_combined_cc, basic_combined_sc, basic_combined_r,
#              ncol = 3, nrow = 4)
#
#
#
# ########################################################################
#
#
#
# ## Figures of basic relationships between time (x) and surrogates/targets (y)
#
# # Figure 13. Relationship between time and coral cover.
# ggplot(data = variables, aes(x = True_Year, y = Percent_Coral_Cover)) +
#   geom_point(size = 3) +
#   scale_x_continuous(name = "Time (Years)") +
#   scale_y_continuous(name = "Coral Cover (%)") +
#   theme(text = element_text(size = 27),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black"))
#
# # Figure 14. Relationship between time and sponge cover.
# ggplot(data = variables, aes(x = True_Year, y = Percent_Sponge_Cover)) +
#   geom_point(size = 3) +
#   scale_x_continuous(name = "Time (Years)") +
#   scale_y_continuous(name = "Sponge Cover (%)") +
#   theme(text = element_text(size = 27),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black"))
#
# # Figure 15. Relationship between time and rugosity.
# ggplot(data = variables, aes(x = True_Year, y = Rugosity)) +
#   geom_point(size = 3) +
#   scale_x_continuous(name = "Time (Years)") +
#   scale_y_continuous(name = "Rugosity") +
#   theme(text = element_text(size = 27),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black"))
#
# # Figure 16. Relationship between time and coral richness.
# ggplot(data = variables, aes(x = True_Year, y = Coral_Richness)) +
#   geom_point(size = 3) +
#   scale_x_continuous(name = "Time (Years)") +
#   scale_y_continuous(name = "Coral Richness") +
#   theme(text = element_text(size = 27),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black"))
#
# # Figure 17. Relationship between time and sponge richness.
# ggplot(data = variables, aes(x = True_Year, y = Sponge_Richness)) +
#   geom_point(size = 3) +
#   scale_x_continuous(name = "Time (Years)") +
#   scale_y_continuous(name = "Sponge Richness") +
#   theme(text = element_text(size = 27),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black"))
# # Resulting warning message same as that from figure 2.
#
# # Figure 18. Relationship between time and fish richness.
# ggplot(data = variables, aes(x = True_Year, y = Fish_Richness)) +
#   geom_point(size = 3) +
#   scale_x_continuous(name = "Time (Years)") +
#   scale_y_continuous(name = "Fish Richness") +
#   theme(text = element_text(size = 27),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black"))
#
# # Figure 19. Relationship between time and combined richness.
# ggplot(data = variables, aes(x = True_Year, y = Combined_Richness)) +
#   geom_point(size = 3) +
#   scale_x_continuous(name = "Time (Years)") +
#   scale_y_continuous(name = "Combined Richness") +
#   theme(text = element_text(size = 27),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black"))
# # Resulting warning message same as that from figure 4.
#
#
#
# ########################################################################
#
#
#
# Create new columns for true year and year values of different types for use in figures
# Note that the column True_Year is type integer
variables$True_Year_Factor <- as.factor(x = variables$True_Year)
variables$True_Year_Numeric <- as.numeric(x = variables$True_Year)
variables$Year_Factor <- as.factor(x = variables$Year)
## Figures of basic relationships between time (x) and surrogates/targets (y) by site (legend)
# Create color palette that is friendly to viewers with color blindness (from https://socviz.co/refineplots.html)
cb_palette <- c("#999999", "#E69F00", "#56B4E9", "#009E73",
"#F0E442", "#0072B2", "#D55E00", "#CC79A7")
#
# # Figure 20. Relationship between time and coral cover by site.
# ggplot(data = variables, aes(x = True_Year_Factor, y = Percent_Coral_Cover, group = Site, color = Site)) +
#   geom_line(size = 1.1) +
#   scale_x_discrete(name = "Time (Years)") +
#   scale_y_continuous(name = "Coral Cover (%)") +
#   scale_color_manual(values = cb_palette) +
#   theme(text = element_text(size = 18),
#         axis.text.x = element_text(angle = +90, hjust = 0),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black"))
#
# # Figure 21. Relationship between time and sponge cover by site.
# ggplot(data = variables, aes(x = True_Year_Factor, y = Percent_Sponge_Cover, group = Site, color = Site)) +
#   geom_line(size = 1.1) +
#   scale_x_discrete(name = "Time (Years)") +
#   scale_y_continuous(name = "Sponge Cover (%)") +
#   scale_color_manual(values = cb_palette) +
#   theme(text = element_text(size= 18),
#         axis.text.x = element_text(angle = +90, hjust = 0),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black"))
#
# # Figure 22. Relationship between time and rugosity by site.
# ggplot(data = variables, aes(x = True_Year_Factor, y = Rugosity, group = Site, color = Site)) +
#   geom_line(size = 1.1) +
#   scale_x_discrete(name = "Time (Years)") +
#   scale_y_continuous(name = "Rugosity") +
#   scale_color_manual(values = cb_palette) +
#   theme(text = element_text(size = 18),
#         axis.text.x = element_text(angle = +90, hjust = 0),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black"))
#
# # Figure 23. Relationship between time and coral richness by site.
# ggplot(data = variables, aes(x = True_Year_Factor, y = Coral_Richness, group = Site, color = Site)) +
#   geom_line(size = 1.1) +
#   scale_x_discrete(name = "Time (Years)") +
#   scale_y_continuous(name = "Coral Richness") +
#   scale_color_manual(values = cb_palette) +
#   theme(text = element_text(size = 18),
#         axis.text.x = element_text(angle = +90, hjust = 0),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black"))
#
# # Figure 24. Relationship between time and sponge richness by site.
# ggplot(data = variables, aes(x = True_Year_Factor, y = Sponge_Richness, group = Site, color = Site)) +
#   geom_line(size = 1.1) +
#   scale_x_discrete(name = "Time (Years)") +
#   scale_y_continuous(name = "Sponge Richness") +
#   scale_color_manual(values = cb_palette) +
#   theme(text = element_text(size = 18),
#         axis.text.x = element_text(angle = +90, hjust = 0),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black"))
# # Resulting warning message same as that from figure 2.
# # The gaps are more apparent in these figures because they have lines instead of points.
#
# # Figure 25. Relationship between time and fish richness by site.
# ggplot(data = variables, aes(x = True_Year_Factor, y = Fish_Richness, group = Site, color = Site)) +
#   geom_line(size = 1.1) +
#   scale_x_discrete(name = "Time (Years)") +
#   scale_y_continuous(name = "Fish Richness") +
#   scale_color_manual(values = cb_palette) +
#   theme(text = element_text(size = 18),
#         axis.text.x = element_text(angle = +90, hjust = 0),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black"))
#
# # Figure 26. Relationship between time and combined richness by site.
# ggplot(data = variables, aes(x = True_Year_Factor, y = Combined_Richness, group = Site, color = Site)) +
#   geom_line(size = 1.1) +
#   scale_x_discrete(name = "Time (Years)") +
#   scale_y_continuous(name = "Combined Richness") +
#   scale_color_manual(values = cb_palette) +
#   theme(text = element_text(size = 18),
#         axis.text.x = element_text(angle = +90, hjust = 0),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black"))
# # Resulting warning message same as that from figure 4.
# # The gaps are more apparent in these figures because they have lines instead of points.
#
#
#
# ########################################################################
#
#
#
# ## Figures of basic relationships between time (x) and surrogates/targets (y) by site (panels)
#
# # Figure 27. Relationship between time and coral cover with sites distinguished by panels.
# ggplot(data = variables, aes(x = True_Year, y = Percent_Coral_Cover)) +
#   geom_point(size = 3) +
#   scale_x_continuous(name = "Time (Years)") +
#   scale_y_continuous(name = "Coral Cover (%)") +
#   theme(text = element_text(size = 18),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black")) +
#   facet_wrap(facets = ~ Site)
#
# # Figure 28. Relationship between time and sponge cover with sites distinguished by panels.
# ggplot(data = variables, aes(x = True_Year, y = Percent_Sponge_Cover)) +
#   geom_point(size = 3) +
#   scale_x_continuous(name = "Time (Years)") +
#   scale_y_continuous(name = "Sponge Cover (%)") +
#   theme(text = element_text(size = 18),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black")) +
#   facet_wrap(facets = ~ Site)
#
# # Figure 29. Relationship between time and rugosity with sites distinguished by panels.
# ggplot(data = variables, aes(x = True_Year, y = Rugosity)) +
#   geom_point(size = 3) +
#   scale_x_continuous(name = "Time (Years)") +
#   scale_y_continuous(name = "Rugosity") +
#   theme(text = element_text(size = 18),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black")) +
#   facet_wrap(facets = ~ Site)
#
# # Figure 30. Relationship between time and coral richness with sites distinguished by panels.
# ggplot(data = variables, aes(x = True_Year, y = Coral_Richness)) +
#   geom_point(size = 3) +
#   scale_x_continuous(name = "Time (Years)") +
#   scale_y_continuous(name = "Coral Richness") +
#   theme(text = element_text(size = 18),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black")) +
#   facet_wrap(facets = ~ Site)
#
# # Figure 31. Relationship between time and sponge richness with sites distinguished by panels.
# ggplot(data = variables, aes(x = True_Year, y = Sponge_Richness)) +
#   geom_point(size = 3) +
#   scale_x_continuous(name = "Time (Years)") +
#   scale_y_continuous(name = "Sponge Richness") +
#   theme(text = element_text(size = 18),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black")) +
#   facet_wrap(facets = ~ Site)
# # Resulting warning message same as that from figure 2.
#
# # Figure 32. Relationship between time and fish richness with sites distinguished by panels.
# ggplot(data = variables, aes(x = True_Year, y = Fish_Richness)) +
#   geom_point(size = 3) +
#   scale_x_continuous(name = "Time (Years)") +
#   scale_y_continuous(name = "Fish Richness") +
#   theme(text = element_text(size = 18),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black")) +
#   facet_wrap(facets = ~ Site)
#
# # Figure 33. Relationship between time and combined richness with sites distinguished by panels.
# ggplot(data = variables, aes(x = True_Year, y = Combined_Richness)) +
#   geom_point(size = 3) +
#   scale_x_continuous(name = "Time (Years)") +
#   scale_y_continuous(name = "Combined Richness") +
#   theme(text = element_text(size = 18),
#         panel.grid.major = element_line(colour = "light gray", size = (0.5)),
#         panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black")) +
#   facet_wrap(facets = ~ Site)
# # Resulting warning message same as that from figure 4.
########################################################################
#######################CORAL RICHNESS###################################
## Figures of competitive models (<2.0 deltaAIC)
# The most parsimonious model for coral richness is coral_cc_yr.
# The function of this model is Coral_Richness ~ Percent_Coral_Cover + Year.
# Create year vector from 0-26 with 100 values each 0.2626 apart
Year <- rep(seq(from = min(variables$Year), to = max(variables$Year), length.out = 100))
# Create coral cover vector from 2.676-61.746 with 100 values 0.596 apart
Percent_Coral_Cover <- rep(seq(from = min(variables$Percent_Coral_Cover), to = max(variables$Percent_Coral_Cover), length.out = 100))
# Make a grid using these vectors (for each Year value, list each value of coral cover)
coral_pred_grid <- expand.grid(Year = Year, Percent_Coral_Cover = Percent_Coral_Cover)
# Add a column for predicted coral richness from these values using the coral_cc_yr model
# Fixed previous issue of richness limits by setting type argument to "response"
coral_pred_grid$Predicted_Coral_Richness <-predict(object = coral_cc_yr, newdata = coral_pred_grid, type = "response")
# Save predictive plot in variable
predicted_coral_plot <- scatterplot3d(x = coral_pred_grid$Year, y = coral_pred_grid$Percent_Coral_Cover, z = coral_pred_grid$Predicted_Coral_Richness,
angle = 35,
color = "black",
pch = 1,
xlab = "Time (Year)",
ylab = "Coral Cover (%)",
zlab = "Coral Richness" )
# Figure 34. Relationship between coral cover and coral richness and time shown in 3 dimensions. Negative binomial distribution used.
predicted_coral_plot
# Add a column so the plot will have the true values compared to the predicted
#predicted_coral_plot$points3d(x = variables$Year, y = variables$Percent_Coral_Cover, z = variables$Coral_Richness, pch = 16)
# 2D alternative to 3D figure
# Note that I created a new model for the sake of creating this figure
coral_cc_yr_asfactor <- glm.nb(formula = Coral_Richness ~ Percent_Coral_Cover + Year_Factor, data = variables)
coral_predictions_2d <- data.frame(
Percent_Coral_Cover = rep(seq(from = min(variables$Percent_Coral_Cover), to = max(variables$Percent_Coral_Cover), length.out = 100), 27),
Year_Factor = factor(rep(1:27, each = 100), levels = 1:27, labels =
levels(variables$Year_Factor)))
coral_predictions_2d <- cbind(coral_predictions_2d, predict(object = coral_cc_yr_asfactor, newdata = coral_predictions_2d, type = "link", se.fit = TRUE))
coral_cc_yr_asfactor <- glm.nb(formula = Coral_Richness ~ Percent_Coral_Cover + Year_Factor, data = variables)
coral_predictions_2d <- data.frame(
Percent_Coral_Cover = rep(seq(from = min(variables$Percent_Coral_Cover), to = max(variables$Percent_Coral_Cover), length.out = 100), 27),
Year_Factor = factor(rep(1:27, each = 100), levels = 1:27, labels =
levels(variables$Year_Factor)))
coral_predictions_2d <- cbind(coral_predictions_2d, predict(object = coral_cc_yr_asfactor, newdata = coral_predictions_2d, type = "link", se.fit = TRUE, interval = "confidence"))
coral_predictions_2d <- within(coral_predictions_2d, {
Predicted_Coral_Richness <- exp(fit)
LL <- exp(fit - 1.96 * se.fit)
UL <- exp(fit + 1.96 * se.fit)
})
coral_predictions_2d <- data.frame(
Percent_Coral_Cover = rep(seq(from = min(variables$Percent_Coral_Cover), to = max(variables$Percent_Coral_Cover), length.out = 100), 27),
Year_Factor = factor(rep(1:27, each = 100), levels = 1:27, labels =
levels(variables$Year_Factor)))
coral_predictions_2d <- cbind(coral_predictions_2d, predict(object = coral_cc_yr_asfactor, newdata = coral_predictions_2d, type = "link", se.fit = F, interval = "confidence"))
View(coral_predictions_2d)
coral_predictions_2d_test <- cbind(coral_predictions_2d, predict(object = coral_cc_yr_asfactor, newdata = coral_predictions_2d, type = "link", se.fit = TRUE, interval = "confidence", level = 0.95))
View(coral_predictions_2d_test)
coral_predictions_2d <- cbind(coral_predictions_2d, predict(object = coral_cc_yr_asfactor, newdata = coral_predictions_2d, type = "link", se.fit = TRUE))
coral_predictions_2d <- within(coral_predictions_2d, {
Predicted_Coral_Richness <- exp(fit)
LL <- exp(fit - 1.96 * se.fit)
UL <- exp(fit + 1.96 * se.fit)
})
ggplot(data = coral_predictions_2d, aes(x = Percent_Coral_Cover, y = Predicted_Coral_Richness)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Year_Factor), alpha = 0.25) +
geom_line(aes(color = Year_Factor), size = 2) +
labs(x = "Coral Cover (%)", y = "Predicted Coral Richness") +
theme(text = element_text(size = 18),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
ggplot(data = variables, aes(x = Percent_Coral_Cover, y = Coral_Richness)) +
geom_point(size = 3)+
scale_x_continuous(name = "Coral Cover (%)") +
scale_y_continuous(name = "Coral Richness") +
geom_smooth(size = 1.2, method = "glm.nb", formula = y ~ x, aes(color = Year_Factor)) +
#scale_color_manual(values = cb_palette) +
theme(text = element_text(size=27),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
