Predicted_Combined_Richness <- exp(fit)
LL <- exp(fit - 1.96 * se.fit)
UL <- exp(fit + 1.96 * se.fit)
})
# Plot for White_Bay
White_Bay_combined_2d <- ggplot(data = combined_predictions_2d, aes(x = Rugosity, y = Predicted_Combined_Richness, color = Year_Factor)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Year_Factor), alpha = 0.25) +
geom_line(aes(color = Year_Factor), size = 2) +
labs(x = "Rugosity - White Bay", y = "Predicted Combined Richness") +
scale_x_continuous(limits = c(10, 80)) +
scale_y_continuous(limits = c(30, 80)) +
theme(text = element_text(size = 18),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
legend.position = "none")
# Monkey_Point
combined_predictions_2d <- data.frame(
Rugosity = rep(seq(from = min(Monkey_Point$Rugosity), to = max(Monkey_Point$Rugosity), length.out = 100), 21),
Year_Factor = factor(rep(1:21, each = 100), levels = 1:21, labels =
levels(Monkey_Point$Year_Factor)))
combined_predictions_2d <- cbind(combined_predictions_2d, predict(object = combined_r_yr_asfactor, newdata = combined_predictions_2d, type = "link", se.fit = TRUE))
combined_predictions_2d <- within(combined_predictions_2d, {
Predicted_Combined_Richness <- exp(fit)
LL <- exp(fit - 1.96 * se.fit)
UL <- exp(fit + 1.96 * se.fit)
})
# Plot for Monkey_Point
Monkey_Point_combined_2d <- ggplot(data = combined_predictions_2d, aes(x = Rugosity, y = Predicted_Combined_Richness, color = Year_Factor)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Year_Factor), alpha = 0.25) +
geom_line(aes(color = Year_Factor), size = 2) +
labs(x = "Rugosity - Monkey Point", y = "Predicted Combined Richness") +
scale_x_continuous(limits = c(10, 80)) +
scale_y_continuous(limits = c(30, 80)) +
theme(text = element_text(size = 18),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
legend.position = "none")
# Guana_Head
combined_predictions_2d <- data.frame(
Rugosity = rep(seq(from = min(Guana_Head$Rugosity), to = max(Guana_Head$Rugosity), length.out = 100), 21),
Year_Factor = factor(rep(1:21, each = 100), levels = 1:21, labels =
levels(Guana_Head$Year_Factor)))
combined_predictions_2d <- cbind(combined_predictions_2d, predict(object = combined_r_yr_asfactor, newdata = combined_predictions_2d, type = "link", se.fit = TRUE))
combined_predictions_2d <- within(combined_predictions_2d, {
Predicted_Combined_Richness <- exp(fit)
LL <- exp(fit - 1.96 * se.fit)
UL <- exp(fit + 1.96 * se.fit)
})
# Plot for Guana_Head
Guana_Head_combined_2d <- ggplot(data = combined_predictions_2d, aes(x = Rugosity, y = Predicted_Combined_Richness, color = Year_Factor)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Year_Factor), alpha = 0.25) +
geom_line(aes(color = Year_Factor), size = 2) +
labs(x = "Rugosity - Guana Head", y = "Predicted Combined Richness") +
scale_x_continuous(limits = c(10, 80)) +
scale_y_continuous(limits = c(30, 80)) +
theme(text = element_text(size = 18),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
# Organize all of these figures into one window
grid.arrange(Pelican_Ghut_combined_2d, Grand_Ghut_combined_2d, Crab_Cove_combined_2d,
Muskmelon_combined_2d, Bigelow_combined_2d, White_Bay_combined_2d,
Monkey_Point_combined_2d, Guana_Head_combined_2d, ncol = 3, nrow = 3)
# Remove ghost factors
combined_complete$Year_Factor <- as.character(combined_complete$Year_Factor)
combined_complete <- combined_complete[combined_complete$Year_Factor != "0" | combined_complete$Year_Factor != "4" | combined_complete$Year_Factor != "5" |
combined_complete$Year_Factor != "6" | combined_complete$Year_Factor != "7" | combined_complete$Year_Factor != "12", ]
# combined_complete <- combined_complete[combined_complete$Year_Factor == "1" | combined_complete$Year_Factor == "2" | combined_complete$Year_Factor == "3" |
#                                          combined_complete$Year_Factor == "8" | combined_complete$Year_Factor == "9" | combined_complete$Year_Factor == "10" |
#                                          combined_complete$Year_Factor == "11" | combined_complete$Year_Factor == "13" | combined_complete$Year_Factor == "14" |
#                                          combined_complete$Year_Factor == "15" | combined_complete$Year_Factor == "16" | combined_complete$Year_Factor == "17" |
#                                          combined_complete$Year_Factor == "18" |combined_complete$Year_Factor == "19" |combined_complete$Year_Factor == "20" |
#                                          combined_complete$Year_Factor == "21" |combined_complete$Year_Factor == "22" |combined_complete$Year_Factor == "23" |
#                                          combined_complete$Year_Factor == "24" |combined_complete$Year_Factor == "25" |combined_complete$Year_Factor == "26", ]
combined_complete$Year_Factor <- as.factor(combined_complete$Year_Factor)
# Order the factor levels for year
combined_complete$Year_Factor <- ordered(combined_complete$Year_Factor,
levels = c("1", "2", "3", "8", "9", "10", "11", "13", "14", "15",
"16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26"))
# Note that model created with year as factor for graphing purposes
combined_r_yr_asfactor <- glm.nb(formula = Combined_Richness ~ Rugosity + Year_Factor, data = combined_complete)
# Re-create subsets without ghost factors
Pelican_Ghut <- combined_complete[which(combined_complete$Site == "pelican"),]
Grand_Ghut <- combined_complete[which(combined_complete$Site == "grand"),]
Crab_Cove <- combined_complete[which(combined_complete$Site == "crab"),]
Muskmelon <- combined_complete[which(combined_complete$Site == "muskN"),]
Bigelow <- combined_complete[which(combined_complete$Site == "bigelow"),]
White_Bay <- combined_complete[which(combined_complete$Site == "white"),]
Monkey_Point <- combined_complete[which(combined_complete$Site == "monkey"),]
Guana_Head <- combined_complete[which(combined_complete$Site == "iguana"),]
# Pelican_Ghut
combined_predictions_2d <- data.frame(
Rugosity = rep(seq(from = min(Pelican_Ghut$Rugosity), to = max(Pelican_Ghut$Rugosity), length.out = 100), 21),
Year_Factor = factor(rep(1:21, each = 100), levels = 1:21, labels =
levels(Pelican_Ghut$Year_Factor)))
combined_predictions_2d <- cbind(combined_predictions_2d, predict(object = combined_r_yr_asfactor, newdata = combined_predictions_2d, type = "link", se.fit = TRUE))
combined_predictions_2d <- within(combined_predictions_2d, {
Predicted_Combined_Richness <- exp(fit)
LL <- exp(fit - 1.96 * se.fit)
UL <- exp(fit + 1.96 * se.fit)
})
# Plot for Pelican_Ghut
Pelican_Ghut_combined_2d <- ggplot(data = combined_predictions_2d, aes(x = Rugosity, y = Predicted_Combined_Richness, color = Year_Factor)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Year_Factor), alpha = 0.25) +
geom_line(aes(color = Year_Factor), size = 2) +
labs(x = "Rugosity - Pelican Ghut", y = "Predicted Combined Richness") +
scale_x_continuous(limits = c(10, 80)) +
scale_y_continuous(limits = c(30, 80)) +
theme(text = element_text(size = 18),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
legend.position = "none")
# Grand_Ghut
combined_predictions_2d <- data.frame(
Rugosity = rep(seq(from = min(Grand_Ghut$Rugosity), to = max(Grand_Ghut$Rugosity), length.out = 100), 21),
Year_Factor = factor(rep(1:21, each = 100), levels = 1:21, labels =
levels(Grand_Ghut$Year_Factor)))
combined_predictions_2d <- cbind(combined_predictions_2d, predict(object = combined_r_yr_asfactor, newdata = combined_predictions_2d, type = "link", se.fit = TRUE))
combined_predictions_2d <- within(combined_predictions_2d, {
Predicted_Combined_Richness <- exp(fit)
LL <- exp(fit - 1.96 * se.fit)
UL <- exp(fit + 1.96 * se.fit)
})
# Plot for Grand_Ghut
Grand_Ghut_combined_2d <- ggplot(data = combined_predictions_2d, aes(x = Rugosity, y = Predicted_Combined_Richness, color = Year_Factor)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Year_Factor), alpha = 0.25) +
geom_line(aes(color = Year_Factor), size = 2) +
labs(x = "Rugosity - Grand Ghut", y = "Predicted Combined Richness") +
scale_x_continuous(limits = c(10, 80)) +
scale_y_continuous(limits = c(30, 80)) +
theme(text = element_text(size = 18),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
legend.position = "none")
# Crab_Cove
combined_predictions_2d <- data.frame(
Rugosity = rep(seq(from = min(Crab_Cove$Rugosity), to = max(Crab_Cove$Rugosity), length.out = 100), 21),
Year_Factor = factor(rep(1:21, each = 100), levels = 1:21, labels =
levels(Crab_Cove$Year_Factor)))
combined_predictions_2d <- cbind(combined_predictions_2d, predict(object = combined_r_yr_asfactor, newdata = combined_predictions_2d, type = "link", se.fit = TRUE))
combined_predictions_2d <- within(combined_predictions_2d, {
Predicted_Combined_Richness <- exp(fit)
LL <- exp(fit - 1.96 * se.fit)
UL <- exp(fit + 1.96 * se.fit)
})
# Plot for Crab_Cove
Crab_Cove_combined_2d <- ggplot(data = combined_predictions_2d, aes(x = Rugosity, y = Predicted_Combined_Richness, color = Year_Factor)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Year_Factor), alpha = 0.25) +
geom_line(aes(color = Year_Factor), size = 2) +
labs(x = "Rugosity - Crab Cove", y = "Predicted Combined Richness") +
scale_x_continuous(limits = c(10, 80)) +
scale_y_continuous(limits = c(30, 80)) +
theme(text = element_text(size = 18),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
legend.position = "none")
# Muskmelon
combined_predictions_2d <- data.frame(
Rugosity = rep(seq(from = min(Muskmelon$Rugosity), to = max(Muskmelon$Rugosity), length.out = 100), 21),
Year_Factor = factor(rep(1:21, each = 100), levels = 1:21, labels =
levels(Muskmelon$Year_Factor)))
combined_predictions_2d <- cbind(combined_predictions_2d, predict(object = combined_r_yr_asfactor, newdata = combined_predictions_2d, type = "link", se.fit = TRUE))
combined_predictions_2d <- within(combined_predictions_2d, {
Predicted_Combined_Richness <- exp(fit)
LL <- exp(fit - 1.96 * se.fit)
UL <- exp(fit + 1.96 * se.fit)
})
# Plot for Muskmelon
Muskmelon_combined_2d <- ggplot(data = combined_predictions_2d, aes(x = Rugosity, y = Predicted_Combined_Richness, color = Year_Factor)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Year_Factor), alpha = 0.25) +
geom_line(aes(color = Year_Factor), size = 2) +
labs(x = "Rugosity - Muskmelon", y = "Predicted Combined Richness") +
scale_x_continuous(limits = c(10, 80)) +
scale_y_continuous(limits = c(30, 80)) +
theme(text = element_text(size = 18),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
legend.position = "none")
# Bigelow
combined_predictions_2d <- data.frame(
Rugosity = rep(seq(from = min(Bigelow$Rugosity), to = max(Bigelow$Rugosity), length.out = 100), 21),
Year_Factor = factor(rep(1:21, each = 100), levels = 1:21, labels =
levels(Bigelow$Year_Factor)))
combined_predictions_2d <- cbind(combined_predictions_2d, predict(object = combined_r_yr_asfactor, newdata = combined_predictions_2d, type = "link", se.fit = TRUE))
combined_predictions_2d <- within(combined_predictions_2d, {
Predicted_Combined_Richness <- exp(fit)
LL <- exp(fit - 1.96 * se.fit)
UL <- exp(fit + 1.96 * se.fit)
})
# Plot for Bigelow
Bigelow_combined_2d <- ggplot(data = combined_predictions_2d, aes(x = Rugosity, y = Predicted_Combined_Richness, color = Year_Factor)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Year_Factor), alpha = 0.25) +
geom_line(aes(color = Year_Factor), size = 2) +
labs(x = "Rugosity - Bigelow", y = "Predicted Combined Richness") +
scale_x_continuous(limits = c(10, 80)) +
scale_y_continuous(limits = c(30, 80)) +
theme(text = element_text(size = 18),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
legend.position = "none")
# White_Bay
combined_predictions_2d <- data.frame(
Rugosity = rep(seq(from = min(White_Bay$Rugosity), to = max(White_Bay$Rugosity), length.out = 100), 21),
Year_Factor = factor(rep(1:21, each = 100), levels = 1:21, labels =
levels(White_Bay$Year_Factor)))
combined_predictions_2d <- cbind(combined_predictions_2d, predict(object = combined_r_yr_asfactor, newdata = combined_predictions_2d, type = "link", se.fit = TRUE))
combined_predictions_2d <- within(combined_predictions_2d, {
Predicted_Combined_Richness <- exp(fit)
LL <- exp(fit - 1.96 * se.fit)
UL <- exp(fit + 1.96 * se.fit)
})
# Plot for White_Bay
White_Bay_combined_2d <- ggplot(data = combined_predictions_2d, aes(x = Rugosity, y = Predicted_Combined_Richness, color = Year_Factor)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Year_Factor), alpha = 0.25) +
geom_line(aes(color = Year_Factor), size = 2) +
labs(x = "Rugosity - White Bay", y = "Predicted Combined Richness") +
scale_x_continuous(limits = c(10, 80)) +
scale_y_continuous(limits = c(30, 80)) +
theme(text = element_text(size = 18),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
legend.position = "none")
# Monkey_Point
combined_predictions_2d <- data.frame(
Rugosity = rep(seq(from = min(Monkey_Point$Rugosity), to = max(Monkey_Point$Rugosity), length.out = 100), 21),
Year_Factor = factor(rep(1:21, each = 100), levels = 1:21, labels =
levels(Monkey_Point$Year_Factor)))
combined_predictions_2d <- cbind(combined_predictions_2d, predict(object = combined_r_yr_asfactor, newdata = combined_predictions_2d, type = "link", se.fit = TRUE))
combined_predictions_2d <- within(combined_predictions_2d, {
Predicted_Combined_Richness <- exp(fit)
LL <- exp(fit - 1.96 * se.fit)
UL <- exp(fit + 1.96 * se.fit)
})
# Plot for Monkey_Point
Monkey_Point_combined_2d <- ggplot(data = combined_predictions_2d, aes(x = Rugosity, y = Predicted_Combined_Richness, color = Year_Factor)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Year_Factor), alpha = 0.25) +
geom_line(aes(color = Year_Factor), size = 2) +
labs(x = "Rugosity - Monkey Point", y = "Predicted Combined Richness") +
scale_x_continuous(limits = c(10, 80)) +
scale_y_continuous(limits = c(30, 80)) +
theme(text = element_text(size = 18),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
legend.position = "none")
# Guana_Head
combined_predictions_2d <- data.frame(
Rugosity = rep(seq(from = min(Guana_Head$Rugosity), to = max(Guana_Head$Rugosity), length.out = 100), 21),
Year_Factor = factor(rep(1:21, each = 100), levels = 1:21, labels =
levels(Guana_Head$Year_Factor)))
combined_predictions_2d <- cbind(combined_predictions_2d, predict(object = combined_r_yr_asfactor, newdata = combined_predictions_2d, type = "link", se.fit = TRUE))
combined_predictions_2d <- within(combined_predictions_2d, {
Predicted_Combined_Richness <- exp(fit)
LL <- exp(fit - 1.96 * se.fit)
UL <- exp(fit + 1.96 * se.fit)
})
# Plot for Guana_Head
Guana_Head_combined_2d <- ggplot(data = combined_predictions_2d, aes(x = Rugosity, y = Predicted_Combined_Richness, color = Year_Factor)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Year_Factor), alpha = 0.25) +
geom_line(aes(color = Year_Factor), size = 2) +
labs(x = "Rugosity - Guana Head", y = "Predicted Combined Richness") +
scale_x_continuous(limits = c(10, 80)) +
scale_y_continuous(limits = c(30, 80)) +
theme(text = element_text(size = 18),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
# Organize all of these figures into one window
grid.arrange(Pelican_Ghut_combined_2d, Grand_Ghut_combined_2d, Crab_Cove_combined_2d,
Muskmelon_combined_2d, Bigelow_combined_2d, White_Bay_combined_2d,
Monkey_Point_combined_2d, Guana_Head_combined_2d, ncol = 3, nrow = 3)
# Remove ghost factors
combined_complete$Year_Factor <- as.character(combined_complete$Year_Factor)
combined_complete <- combined_complete[combined_complete$Year_Factor != "0" | combined_complete$Year_Factor != "4" | combined_complete$Year_Factor != "5" |
combined_complete$Year_Factor != "6" | combined_complete$Year_Factor != "7" | combined_complete$Year_Factor != "12", ]
combined_complete$Year_Factor <- as.factor(combined_complete$Year_Factor)
# Order the factor levels for year
combined_complete$Year_Factor <- ordered(combined_complete$Year_Factor,
levels = c("1", "2", "3", "8", "9", "10", "11", "13", "14", "15",
"16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26"))
# Note that model created with year as factor for graphing purposes
combined_r_yr_asfactor <- glm.nb(formula = Combined_Richness ~ Rugosity + Year_Factor, data = combined_complete)
# Re-create subsets without ghost factors
Pelican_Ghut <- combined_complete[which(combined_complete$Site == "pelican"),]
Grand_Ghut <- combined_complete[which(combined_complete$Site == "grand"),]
Crab_Cove <- combined_complete[which(combined_complete$Site == "crab"),]
Muskmelon <- combined_complete[which(combined_complete$Site == "muskN"),]
Bigelow <- combined_complete[which(combined_complete$Site == "bigelow"),]
White_Bay <- combined_complete[which(combined_complete$Site == "white"),]
Monkey_Point <- combined_complete[which(combined_complete$Site == "monkey"),]
Guana_Head <- combined_complete[which(combined_complete$Site == "iguana"),]
# Pelican_Ghut
combined_predictions_2d <- data.frame(
Rugosity = rep(seq(from = min(Pelican_Ghut$Rugosity), to = max(Pelican_Ghut$Rugosity), length.out = 100), 21),
Year_Factor = factor(rep(1:21, each = 100), levels = 1:21, labels =
levels(Pelican_Ghut$Year_Factor)))
combined_predictions_2d <- cbind(combined_predictions_2d, predict(object = combined_r_yr_asfactor, newdata = combined_predictions_2d, type = "link", se.fit = TRUE))
combined_predictions_2d <- within(combined_predictions_2d, {
Predicted_Combined_Richness <- exp(fit)
LL <- exp(fit - 1.96 * se.fit)
UL <- exp(fit + 1.96 * se.fit)
})
# Plot for Pelican_Ghut
Pelican_Ghut_combined_2d <- ggplot(data = combined_predictions_2d, aes(x = Rugosity, y = Predicted_Combined_Richness, color = Year_Factor)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Year_Factor), alpha = 0.25) +
geom_line(aes(color = Year_Factor), size = 2) +
labs(x = "Rugosity - Pelican Ghut", y = "Predicted Combined Richness") +
scale_x_continuous(limits = c(10, 80)) +
scale_y_continuous(limits = c(30, 80)) +
theme(text = element_text(size = 18),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black")
#legend.position = "none"
)
# Grand_Ghut
combined_predictions_2d <- data.frame(
Rugosity = rep(seq(from = min(Grand_Ghut$Rugosity), to = max(Grand_Ghut$Rugosity), length.out = 100), 21),
Year_Factor = factor(rep(1:21, each = 100), levels = 1:21, labels =
levels(Grand_Ghut$Year_Factor)))
combined_predictions_2d <- cbind(combined_predictions_2d, predict(object = combined_r_yr_asfactor, newdata = combined_predictions_2d, type = "link", se.fit = TRUE))
combined_predictions_2d <- within(combined_predictions_2d, {
Predicted_Combined_Richness <- exp(fit)
LL <- exp(fit - 1.96 * se.fit)
UL <- exp(fit + 1.96 * se.fit)
})
# Plot for Grand_Ghut
Grand_Ghut_combined_2d <- ggplot(data = combined_predictions_2d, aes(x = Rugosity, y = Predicted_Combined_Richness, color = Year_Factor)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Year_Factor), alpha = 0.25) +
geom_line(aes(color = Year_Factor), size = 2) +
labs(x = "Rugosity - Grand Ghut", y = "Predicted Combined Richness") +
scale_x_continuous(limits = c(10, 80)) +
scale_y_continuous(limits = c(30, 80)) +
theme(text = element_text(size = 18),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black")
#legend.position = "none"
)
# Crab_Cove
combined_predictions_2d <- data.frame(
Rugosity = rep(seq(from = min(Crab_Cove$Rugosity), to = max(Crab_Cove$Rugosity), length.out = 100), 21),
Year_Factor = factor(rep(1:21, each = 100), levels = 1:21, labels =
levels(Crab_Cove$Year_Factor)))
combined_predictions_2d <- cbind(combined_predictions_2d, predict(object = combined_r_yr_asfactor, newdata = combined_predictions_2d, type = "link", se.fit = TRUE))
combined_predictions_2d <- within(combined_predictions_2d, {
Predicted_Combined_Richness <- exp(fit)
LL <- exp(fit - 1.96 * se.fit)
UL <- exp(fit + 1.96 * se.fit)
})
# Plot for Crab_Cove
Crab_Cove_combined_2d <- ggplot(data = combined_predictions_2d, aes(x = Rugosity, y = Predicted_Combined_Richness, color = Year_Factor)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Year_Factor), alpha = 0.25) +
geom_line(aes(color = Year_Factor), size = 2) +
labs(x = "Rugosity - Crab Cove", y = "Predicted Combined Richness") +
scale_x_continuous(limits = c(10, 80)) +
scale_y_continuous(limits = c(30, 80)) +
theme(text = element_text(size = 18),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black")
#legend.position = "none"
)
# Muskmelon
combined_predictions_2d <- data.frame(
Rugosity = rep(seq(from = min(Muskmelon$Rugosity), to = max(Muskmelon$Rugosity), length.out = 100), 21),
Year_Factor = factor(rep(1:21, each = 100), levels = 1:21, labels =
levels(Muskmelon$Year_Factor)))
combined_predictions_2d <- cbind(combined_predictions_2d, predict(object = combined_r_yr_asfactor, newdata = combined_predictions_2d, type = "link", se.fit = TRUE))
combined_predictions_2d <- within(combined_predictions_2d, {
Predicted_Combined_Richness <- exp(fit)
LL <- exp(fit - 1.96 * se.fit)
UL <- exp(fit + 1.96 * se.fit)
})
# Plot for Muskmelon
Muskmelon_combined_2d <- ggplot(data = combined_predictions_2d, aes(x = Rugosity, y = Predicted_Combined_Richness, color = Year_Factor)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Year_Factor), alpha = 0.25) +
geom_line(aes(color = Year_Factor), size = 2) +
labs(x = "Rugosity - Muskmelon", y = "Predicted Combined Richness") +
scale_x_continuous(limits = c(10, 80)) +
scale_y_continuous(limits = c(30, 80)) +
theme(text = element_text(size = 18),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black")
#legend.position = "none"
)
# Bigelow
combined_predictions_2d <- data.frame(
Rugosity = rep(seq(from = min(Bigelow$Rugosity), to = max(Bigelow$Rugosity), length.out = 100), 21),
Year_Factor = factor(rep(1:21, each = 100), levels = 1:21, labels =
levels(Bigelow$Year_Factor)))
combined_predictions_2d <- cbind(combined_predictions_2d, predict(object = combined_r_yr_asfactor, newdata = combined_predictions_2d, type = "link", se.fit = TRUE))
combined_predictions_2d <- within(combined_predictions_2d, {
Predicted_Combined_Richness <- exp(fit)
LL <- exp(fit - 1.96 * se.fit)
UL <- exp(fit + 1.96 * se.fit)
})
# Plot for Bigelow
Bigelow_combined_2d <- ggplot(data = combined_predictions_2d, aes(x = Rugosity, y = Predicted_Combined_Richness, color = Year_Factor)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Year_Factor), alpha = 0.25) +
geom_line(aes(color = Year_Factor), size = 2) +
labs(x = "Rugosity - Bigelow", y = "Predicted Combined Richness") +
scale_x_continuous(limits = c(10, 80)) +
scale_y_continuous(limits = c(30, 80)) +
theme(text = element_text(size = 18),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black")
#legend.position = "none"
)
# White_Bay
combined_predictions_2d <- data.frame(
Rugosity = rep(seq(from = min(White_Bay$Rugosity), to = max(White_Bay$Rugosity), length.out = 100), 21),
Year_Factor = factor(rep(1:21, each = 100), levels = 1:21, labels =
levels(White_Bay$Year_Factor)))
combined_predictions_2d <- cbind(combined_predictions_2d, predict(object = combined_r_yr_asfactor, newdata = combined_predictions_2d, type = "link", se.fit = TRUE))
combined_predictions_2d <- within(combined_predictions_2d, {
Predicted_Combined_Richness <- exp(fit)
LL <- exp(fit - 1.96 * se.fit)
UL <- exp(fit + 1.96 * se.fit)
})
# Plot for White_Bay
White_Bay_combined_2d <- ggplot(data = combined_predictions_2d, aes(x = Rugosity, y = Predicted_Combined_Richness, color = Year_Factor)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Year_Factor), alpha = 0.25) +
geom_line(aes(color = Year_Factor), size = 2) +
labs(x = "Rugosity - White Bay", y = "Predicted Combined Richness") +
scale_x_continuous(limits = c(10, 80)) +
scale_y_continuous(limits = c(30, 80)) +
theme(text = element_text(size = 18),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black")
#legend.position = "none"
)
# Monkey_Point
combined_predictions_2d <- data.frame(
Rugosity = rep(seq(from = min(Monkey_Point$Rugosity), to = max(Monkey_Point$Rugosity), length.out = 100), 21),
Year_Factor = factor(rep(1:21, each = 100), levels = 1:21, labels =
levels(Monkey_Point$Year_Factor)))
combined_predictions_2d <- cbind(combined_predictions_2d, predict(object = combined_r_yr_asfactor, newdata = combined_predictions_2d, type = "link", se.fit = TRUE))
combined_predictions_2d <- within(combined_predictions_2d, {
Predicted_Combined_Richness <- exp(fit)
LL <- exp(fit - 1.96 * se.fit)
UL <- exp(fit + 1.96 * se.fit)
})
# Plot for Monkey_Point
Monkey_Point_combined_2d <- ggplot(data = combined_predictions_2d, aes(x = Rugosity, y = Predicted_Combined_Richness, color = Year_Factor)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Year_Factor), alpha = 0.25) +
geom_line(aes(color = Year_Factor), size = 2) +
labs(x = "Rugosity - Monkey Point", y = "Predicted Combined Richness") +
scale_x_continuous(limits = c(10, 80)) +
scale_y_continuous(limits = c(30, 80)) +
theme(text = element_text(size = 18),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black")
#legend.position = "none"
)
# Guana_Head
combined_predictions_2d <- data.frame(
Rugosity = rep(seq(from = min(Guana_Head$Rugosity), to = max(Guana_Head$Rugosity), length.out = 100), 21),
Year_Factor = factor(rep(1:21, each = 100), levels = 1:21, labels =
levels(Guana_Head$Year_Factor)))
combined_predictions_2d <- cbind(combined_predictions_2d, predict(object = combined_r_yr_asfactor, newdata = combined_predictions_2d, type = "link", se.fit = TRUE))
combined_predictions_2d <- within(combined_predictions_2d, {
Predicted_Combined_Richness <- exp(fit)
LL <- exp(fit - 1.96 * se.fit)
UL <- exp(fit + 1.96 * se.fit)
})
# Plot for Guana_Head
Guana_Head_combined_2d <- ggplot(data = combined_predictions_2d, aes(x = Rugosity, y = Predicted_Combined_Richness, color = Year_Factor)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = Year_Factor), alpha = 0.25) +
geom_line(aes(color = Year_Factor), size = 2) +
labs(x = "Rugosity - Guana Head", y = "Predicted Combined Richness") +
scale_x_continuous(limits = c(10, 80)) +
scale_y_continuous(limits = c(30, 80)) +
theme(text = element_text(size = 18),
panel.grid.major = element_line(colour = "light gray", size = (0.5)),
panel.grid.minor = element_line(colour = "light gray", size = (0.5)),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
# Organize all of these figures into one window
grid.arrange(Pelican_Ghut_combined_2d, Grand_Ghut_combined_2d, Crab_Cove_combined_2d,
Muskmelon_combined_2d, Bigelow_combined_2d, White_Bay_combined_2d,
Monkey_Point_combined_2d, Guana_Head_combined_2d, ncol = 3, nrow = 3)
